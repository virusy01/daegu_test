<link rel="import" href="/bower_components/iron-pages/iron-pages.html">
<link rel="import" href="/bower_components/iron-location/iron-location.html">

<link rel="import" href="/src/pages/page-corpinfo.html">

<link rel="import" href="/src/components/common/normal-select.html">

<dom-module id="center-status-view">
	<template>
		<iron-location id="location"></iron-location>

		<div class="row">
			<div class="col-xs-12 text-right">
				<button type="button" on-tap="_toList" class="btn btn-sm btn-default">목록으로</button>
			</div>
		</div>

		<div class="horizontal-margin-20"></div>

		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">나비프로젝트 </h3>
			</div>
			<div class="panel-body">
				<page-corpinfo admin-mode="true" read-id="{{id}}"></page-corpinfo>
			</div>
		</div>

	</template>
	<script>
        Polymer({
            is: 'center-status-view',

            properties: {
                id: Number,
                tab: {
                    type: String,
                    value: 'income',
                    observer: "_selectTab"
                },
                tabYearly: {
                    type: String,
                    observer: '_selectTabYearly'
                },
                _yearList: {
                    type: Array,
                    value: function() {
                        var list = [];

                        for (var i = 2013; i <= 2030; i++) {
                            list.push({cdNm:i, cd:i});
                        }

                        return list;
                    }
                },
                _year: {
                    type: Number,
                    value: function() {
                        return moment().year();
                    }
                },
                _yearForYearly: {
                    type: Number,
                    value: function() {
                        return moment().year();
                    }
                },
            },

            attached: function() {
                this.async(function() {
                    this.tabYearly = 'economic';
                }, 1000);
            },

            _changeTab: function(e) {
                var name = e.currentTarget.getAttribute('name');

                this.tab = name;
            },

            _changeYearlyTab: function(e) {
                var name = e.currentTarget.getAttribute('name');
                this.tabYearly = name;
            },

            _selectTab: function(newValue, oldValue) {
                var newTab = this.$.pageTab.querySelector("li[name='" + newValue + "']");
                var oldTab = this.$.pageTab.querySelector("li[name='" + oldValue +"']");

                newTab.classList.add('active');
                if (oldTab)
                    oldTab.classList.remove('active');

                this.importHref(
                    this.resolveUrl('/src/pages/report/report-' + newValue + '.html'), null, null, true);
            },

            _selectTabYearly: function(newValue, oldValue) {
                var newTab = this.$.pageTabYearly.querySelector("li[name='" + newValue + "']");
                var oldTab = this.$.pageTabYearly.querySelector("li[name='" + oldValue +"']");

                newTab.classList.add('active');
                if (oldTab)
                    oldTab.classList.remove('active');

                this.importHref(
                    this.resolveUrl('/src/pages/report/report-' + newValue + '.html'), null, null, true);
            },


            _getData: function(e) {
                this.$.reportTabs.selectedItem.requestData();
            },

            _getDataYearly: function(e) {
                this.$.reportTabsYearly.selectedItem.requestData();
            },

            _toList: function(e) {
                this.$.location.path = '/app/center-status/list/';
            },
        });
	</script>
</dom-module>
