<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="snp.app.hq.HqRepository">
	<!-- 사회적기업 목록 -->
	<select id="findSocialList" resultType="hashmap">
		SELECT
		 CORP_SEQ
		, CORP_NM
		, OPEN_DT
		, SE_YN
		, ORG_TYPE
		, BEFORE_TYPE
		, LEG_TYPE1
		, LEG_TYPE2
		, MAIN_TYPE
		, SECTOR
		, REGION
		FROM CORP_INFO_SE
	</select>

	<!-- 사회적기업 상세정보 -->
	<select id="findSocialInfo" resultType="hashmap">
		SELECT
		 CORP_NM
		, OPEN_DT
		, SE_YN
		, ORG_TYPE
		, BEFORE_TYPE
		, LEG_TYPE1
		, LEG_TYPE2
		, MAIN_TYPE
		, SECTOR
		, HISTORY
		, REGION
		, LIFE_CHG
		, LOCAL_SOL
		, CITY_ENL
		, WEAK_CHG
		, WEAK_ENL
		, PROD_NM
		, PROD_PCT
		, SERVICE_NM
		, SERVICE_PCT
		, IN_TOT1
		, IN_SEE1
		, IN_TOT2
		, IN_SEE2
		, IN_TOT3
		, IN_SEE3
		, OUT_TOT1
		, OUT_SEE1
		, OUT_TOT2
		, OUT_SEE2
		, OUT_TOT3
		, OUT_SEE3
		, SAILS_PCT1
		, SAILS_PCT2
		, SAILS_PCT3
		, SAILS_PCT4
		, SAILS_PCT5
		, TOT_PAR
		, TOT_EMP
		, MALE_CNT
		, FMALE_CNT
		, REG_EMP_CNT
		, REG_WEEK_TIME
		, REG_MONTH_PAY
		, REG_EMP_TIME
		, COM_EMP_CNT
		, COM_WEEK_TIME
		, COM_MONTH_PAY
		, COM_EMP_TIME
		, CONTRACT_EMP_CNT
		, CONTRACT_WEEK_TIME
		, CONTRACT_MONTH_PAY
		, CONTRACT_EMP_TIME
		, TIME_EMP_CNT
		, TIME_WEEK_TIME
		, TIME_MONTH_PAY
		, TIME_EMP_TIME
		, SPE_EMP_CNT
		, SPE_WEEK_TIME
		, SPE_MONTH_PAY
		, SPE_EMP_TIME
		, VOL_EMP_CNT
		, VOL_WEEK_TIME
		, AVG_YEAR
		, WEAK_TOT_EMP
		, WEAK_MALE_CNT
		, WEAK_FMALE_CNT
		, WEAK_REG_EMP_CNT
		, WEAK_REG_WEEK_TIME
		, WEAK_REG_MONTH_PAY
		, WEAK_REG_EMP_TIME
		, WEAK_COM_EMP_CNT
		, WEAK_COM_WEEK_TIME
		, WEAK_COM_MONTH_PAY
		, WEAK_COM_EMP_TIME
		, WEAK_CONTRACT_EMP_CNT
		, WEAK_CONTRACT_WEEK_TIME
		, WEAK_CONTRACT_MONTH_PAY
		, WEAK_CONTRACT_EMP_TIME
		, WEAK_TIME_EMP_CNT
		, WEAK_TIME_WEEK_TIME
		, WEAK_TIME_MONTH_PAY
		, WEAK_TIME_EMP_TIME
		, WEAK_SPE_EMP_CNT
		, WEAK_SPE_WEEK_TIME
		, WEAK_SPE_MONTH_PAY
		, WEAK_SPE_EMP_TIME
		, WEAK_VOL_EMP_CNT
		, WEAK_VOL_WEEK_TIME
		, WEAK_AVG_YEAR
		, WEAK_TYPE1_CNT
		, WEAK_TYPE2_CNT
		, WEAK_TYPE3_CNT
		, WEAK_TYPE4_CNT
		, WEAK_TYPE5_CNT
		, WEAK_TYPE6_CNT
		, WEAK_TYPE7_CNT
		, FIRST_REASON
		, SECOND_REASON
		, ETC_REASON
		, CORP_ASSET
		, CORP_CAPITAL
		, CORP_DEBT
		, CORP_SALES
		, CORP_SALES_PROFIT
		, CORP_LABOR_COST
		, CORP_TAX
		, CORP_OP_PROFIT
		, CORP_NET_INCOM
		, GOV_SUP_ASSET
		, GOV_SUP_COST
		, SPONSOR_DONATE
		, FUNDS_REVENUE
		, FUNDS_DONATE
		, FUNDS_SUPP
		, FUNDS_LOAN
		, FUNDS_ETC
		FROM CORP_INFO_SE
		WHERE CORP_SEQ = #{CORP_SEQ}
	</select>

	<insert id="insertSocialInfo">
		INSERT INTO CORP_INFO_SE
		(
		 CORP_NM
		, OPEN_DT
		, SE_YN
		, ORG_TYPE
		, BEFORE_TYPE
		, LEG_TYPE1
		, LEG_TYPE2
		, MAIN_TYPE
		, SECTOR
		, HISTORY
		, REGION
		, LIFE_CHG
		, LOCAL_SOL
		, CITY_ENL
		, WEAK_CHG
		, WEAK_ENL
		, PROD_NM
		, PROD_PCT
		, SERVICE_NM
		, SERVICE_PCT
		, IN_TOT1
		, IN_SEE1
		, IN_TOT2
		, IN_SEE2
		, IN_TOT3
		, IN_SEE3
		, OUT_TOT1
		, OUT_SEE1
		, OUT_TOT2
		, OUT_SEE2
		, OUT_TOT3
		, OUT_SEE3
		, SAILS_PCT1
		, SAILS_PCT2
		, SAILS_PCT3
		, SAILS_PCT4
		, SAILS_PCT5
		, TOT_PAR
		, TOT_EMP
		, MALE_CNT
		, FMALE_CNT
		, REG_EMP_CNT
		, REG_WEEK_TIME
		, REG_MONTH_PAY
		, REG_EMP_TIME
		, COM_EMP_CNT
		, COM_WEEK_TIME
		, COM_MONTH_PAY
		, COM_EMP_TIME
		, CONTRACT_EMP_CNT
		, CONTRACT_WEEK_TIME
		, CONTRACT_MONTH_PAY
		, CONTRACT_EMP_TIME
		, TIME_EMP_CNT
		, TIME_WEEK_TIME
		, TIME_MONTH_PAY
		, TIME_EMP_TIME
		, SPE_EMP_CNT
		, SPE_WEEK_TIME
		, SPE_MONTH_PAY
		, SPE_EMP_TIME
		, VOL_EMP_CNT
		, VOL_WEEK_TIME
		, AVG_YEAR
		, WEAK_TOT_EMP
		, WEAK_MALE_CNT
		, WEAK_FMALE_CNT
		, WEAK_REG_EMP_CNT
		, WEAK_REG_WEEK_TIME
		, WEAK_REG_MONTH_PAY
		, WEAK_REG_EMP_TIME
		, WEAK_COM_EMP_CNT
		, WEAK_COM_WEEK_TIME
		, WEAK_COM_MONTH_PAY
		, WEAK_COM_EMP_TIME
		, WEAK_CONTRACT_EMP_CNT
		, WEAK_CONTRACT_WEEK_TIME
		, WEAK_CONTRACT_MONTH_PAY
		, WEAK_CONTRACT_EMP_TIME
		, WEAK_TIME_EMP_CNT
		, WEAK_TIME_WEEK_TIME
		, WEAK_TIME_MONTH_PAY
		, WEAK_TIME_EMP_TIME
		, WEAK_SPE_EMP_CNT
		, WEAK_SPE_WEEK_TIME
		, WEAK_SPE_MONTH_PAY
		, WEAK_SPE_EMP_TIME
		, WEAK_VOL_EMP_CNT
		, WEAK_VOL_WEEK_TIME
		, WEAK_AVG_YEAR
		, WEAK_TYPE1_CNT
		, WEAK_TYPE2_CNT
		, WEAK_TYPE3_CNT
		, WEAK_TYPE4_CNT
		, WEAK_TYPE5_CNT
		, WEAK_TYPE6_CNT
		, WEAK_TYPE7_CNT
		, FIRST_REASON
		, SECOND_REASON
		, ETC_REASON
		, CORP_ASSET
		, CORP_CAPITAL
		, CORP_DEBT
		, CORP_SALES
		, CORP_SALES_PROFIT
		, CORP_LABOR_COST
		, CORP_TAX
		, CORP_OP_PROFIT
		, CORP_NET_INCOM
		, GOV_SUP_ASSET
		, GOV_SUP_COST
		, SPONSOR_DONATE
		, FUNDS_REVENUE
		, FUNDS_DONATE
		, FUNDS_SUPP
		, FUNDS_LOAN
		, FUNDS_ETC
		, REG_ID
		, REG_DT
		)
		VALUES
		(
		  #{p.COPR_SEQ}
		, #{p.CORP_NM}
		, #{p.OPEN_DT, typeHandler=snp.spring.mybatis.DateHandler}
		, #{p.SE_YN}
		, #{p.ORG_TYPE}
		, #{p.BEFORE_TYPE}
		, #{p.LEG_TYPE1}
		, #{p.LEG_TYPE2}
		, #{p.MAIN_TYPE}
		, #{p.SECTOR}
		, #{p.HISTORY}
		, #{p.REGION}
		, #{p.LIFE_CHG}
		, #{p.LOCAL_SOL}
		, #{p.CITY_ENL}
		, #{p.WEAK_CHG}
		, #{p.WEAK_ENL}
		, #{p.PROD_NM}
		, #{p.PROD_PCT}
		, #{p.SERVICE_NM}
		, #{p.SERVICE_PCT}
		, #{p.IN_TOT1}
		, #{p.IN_SEE1}
		, #{p.IN_TOT2}
		, #{p.IN_SEE2}
		, #{p.IN_TOT3}
		, #{p.IN_SEE3}
		, #{p.OUT_TOT1}
		, #{p.OUT_SEE1}
		, #{p.OUT_TOT2}
		, #{p.OUT_SEE2}
		, #{p.OUT_TOT3}
		, #{p.OUT_SEE3}
		, #{p.SAILS_PCT1}
		, #{p.SAILS_PCT2}
		, #{p.SAILS_PCT3}
		, #{p.SAILS_PCT4}
		, #{p.SAILS_PCT5}
		, #{p.TOT_PAR}
		, #{p.TOT_EMP}
		, #{p.MALE_CNT}
		, #{p.FMALE_CNT}
		, #{p.REG_EMP_CNT}
		, #{p.REG_WEEK_TIME}
		, #{p.REG_MONTH_PAY}
		, #{p.REG_EMP_TIME}
		, #{p.COM_EMP_CNT}
		, #{p.COM_WEEK_TIME}
		, #{p.COM_MONTH_PAY}
		, #{p.COM_EMP_TIME}
		, #{p.CONTRACT_EMP_CNT}
		, #{p.CONTRACT_WEEK_TIME}
		, #{p.CONTRACT_MONTH_PAY}
		, #{p.CONTRACT_EMP_TIME}
		, #{p.TIME_EMP_CNT}
		, #{p.TIME_WEEK_TIME}
		, #{p.TIME_MONTH_PAY}
		, #{p.TIME_EMP_TIME}
		, #{p.SPE_EMP_CNT}
		, #{p.SPE_WEEK_TIME}
		, #{p.SPE_MONTH_PAY}
		, #{p.SPE_EMP_TIME}
		, #{p.VOL_EMP_CNT}
		, #{p.VOL_WEEK_TIME}
		, #{p.AVG_YEAR}
		, #{p.WEAK_TOT_EMP}
		, #{p.WEAK_MALE_CNT}
		, #{p.WEAK_FMALE_CNT}
		, #{p.WEAK_REG_EMP_CNT}
		, #{p.WEAK_REG_WEEK_TIME}
		, #{p.WEAK_REG_MONTH_PAY}
		, #{p.WEAK_REG_EMP_TIME}
		, #{p.WEAK_COM_EMP_CNT}
		, #{p.WEAK_COM_WEEK_TIME}
		, #{p.WEAK_COM_MONTH_PAY}
		, #{p.WEAK_COM_EMP_TIME}
		, #{p.WEAK_CONTRACT_EMP_CNT}
		, #{p.WEAK_CONTRACT_WEEK_TIME}
		, #{p.WEAK_CONTRACT_MONTH_PAY}
		, #{p.WEAK_CONTRACT_EMP_TIME}
		, #{p.WEAK_TIME_EMP_CNT}
		, #{p.WEAK_TIME_WEEK_TIME}
		, #{p.WEAK_TIME_MONTH_PAY}
		, #{p.WEAK_TIME_EMP_TIME}
		, #{p.WEAK_SPE_EMP_CNT}
		, #{p.WEAK_SPE_WEEK_TIME}
		, #{p.WEAK_SPE_MONTH_PAY}
		, #{p.WEAK_SPE_EMP_TIME}
		, #{p.WEAK_VOL_EMP_CNT}
		, #{p.WEAK_VOL_WEEK_TIME}
		, #{p.WEAK_AVG_YEAR}
		, #{p.WEAK_TYPE1_CNT}
		, #{p.WEAK_TYPE2_CNT}
		, #{p.WEAK_TYPE3_CNT}
		, #{p.WEAK_TYPE4_CNT}
		, #{p.WEAK_TYPE5_CNT}
		, #{p.WEAK_TYPE6_CNT}
		, #{p.WEAK_TYPE7_CNT}
		, #{p.FIRST_REASON}
		, #{p.SECOND_REASON}
		, #{p.ETC_REASON}
		, #{p.CORP_ASSET}
		, #{p.CORP_CAPITAL}
		, #{p.CORP_DEBT}
		, #{p.CORP_SALES}
		, #{p.CORP_SALES_PROFIT}
		, #{p.CORP_LABOR_COST}
		, #{p.CORP_TAX}
		, #{p.CORP_OP_PROFIT}
		, #{p.CORP_NET_INCOM}
		, #{p.GOV_SUP_ASSET}
		, #{p.GOV_SUP_COST}
		, #{p.SPONSOR_DONATE}
		, #{p.FUNDS_REVENUE}
		, #{p.FUNDS_DONATE}
		, #{p.FUNDS_SUPP}
		, #{p.FUNDS_LOAN}
		, #{p.FUNDS_ETC}
		, #{u.userId}
		, now()
		)
	</insert>

	<update id="updateSocialInfo">
		UPDATE CORP_INFO_SE
		SET
	    CORP_NM           = #{p.CORP_NM}
	    , OPEN_DT           = #{p.OPEN_DT, typeHandler=snp.spring.mybatis.DateHandler}
		, SE_YN            = #{p.SE_YN}
		, ORG_TYPE            = #{p.ORG_TYPE}
		, BEFORE_TYPE           = #{p.BEFORE_TYPE}
		, LEG_TYPE1            = #{p.LEG_TYPE1}
		, LEG_TYPE2     = #{p.LEG_TYPE2}
		, MAIN_TYPE        = #{p.MAIN_TYPE}
		, SECTOR 		= #{p.SECTOR}
		, HISTORY 		= #{p.HISTORY}
		, REGION         = #{p.REGION}
		, LIFE_CHG		= #{p.LIFE_CHG}
		, LOCAL_SOL		= #{p.LOCAL_SOL}
		, CITY_ENL		= #{p.CITY_ENL}
		, WEAK_CHG		= #{p.WEAK_CHG}
		, WEAK_ENL		= #{p.WEAK_ENL}
		, PROD_NM		= #{p.PROD_NM}
		, PROD_PCT		= #{p.PROD_PCT}
		, SERVICE_NM		= #{p.SERVICE_NM}
		, SERVICE_PCT		= #{p.SERVICE_PCT}
		, IN_TOT1		= #{p.IN_TOT1}
		, IN_SEE1		= #{p.IN_SEE1}
		, IN_TOT2		= #{p.IN_TOT2}
		, IN_SEE2		= #{p.IN_SEE2}
		, IN_TOT3		= #{p.IN_TOT3}
		, IN_SEE3		= #{p.IN_SEE3}
		, OUT_TOT1 		= #{p.OUT_TOT1}
		, OUT_SEE1		= #{p.OUT_SEE1}
		, OUT_TOT2		= #{p.OUT_TOT2}
		, OUT_SEE2		= #{p.OUT_SEE2}
		, OUT_TOT3		= #{p.OUT_TOT3}
		, OUT_SEE3		= #{p.OUT_SEE3}
		, SAILS_PCT1		= #{p.SAILS_PCT1}
		, SAILS_PCT2		= #{p.SAILS_PCT2}
		, SAILS_PCT3		= #{p.SAILS_PCT3}
		, SAILS_PCT4		= #{p.SAILS_PCT4}
		, SAILS_PCT5		= #{p.SAILS_PCT5}
		, TOT_PAR		= #{p.TOT_PAR}
		, TOT_EMP		= #{p.TOT_EMP}
		, MALE_CNT		= #{p.MALE_CNT}
		, FMALE_CNT		= #{p.FMALE_CNT}
		, REG_EMP_CNT		= #{p.REG_EMP_CNT}
		, REG_WEEK_TIME		= #{p.REG_WEEK_TIME}
		, REG_MONTH_PAY		= #{p.REG_MONTH_PAY}
		, REG_EMP_TIME		= #{p.REG_EMP_TIME}
		, COM_EMP_CNT		= #{p.COM_EMP_CNT}
		, COM_WEEK_TIME		= #{p.COM_WEEK_TIME}
		, COM_MONTH_PAY		= #{p.COM_MONTH_PAY}
		, COM_EMP_TIME		= #{p.COM_EMP_TIME}
		, CONTRACT_EMP_CNT		= #{p.CONTRACT_EMP_CNT}
		, CONTRACT_WEEK_TIME		= #{p.CONTRACT_WEEK_TIME}
		, CONTRACT_MONTH_PAY		= #{p.CONTRACT_MONTH_PAY}
		, CONTRACT_EMP_TIME		= #{p.CONTRACT_EMP_TIME}
		, TIME_EMP_CNT		= #{p.TIME_EMP_CNT}
		, TIME_WEEK_TIME		= #{p.TIME_WEEK_TIME}
		, TIME_MONTH_PAY		= #{p.TIME_MONTH_PAY}
		, TIME_EMP_TIME		= #{p.TIME_EMP_TIME}
		, SPE_EMP_CNT		= #{p.SPE_EMP_CNT}
		, SPE_WEEK_TIME		= #{p.SPE_WEEK_TIME}
		, SPE_MONTH_PAY		= #{p.SPE_MONTH_PAY}
		, SPE_EMP_TIME		= #{p.SPE_EMP_TIME}
		, VOL_EMP_CNT		= #{p.VOL_EMP_CNT}
		, VOL_WEEK_TIME		= #{p.VOL_WEEK_TIME}
		, AVG_YEAR		= #{p.AVG_YEAR}
		, WEAK_TOT_EMP		= #{p.WEAK_TOT_EMP}
		, WEAK_MALE_CNT		= #{p.WEAK_MALE_CNT}
		, WEAK_FMALE_CNT		= #{p.WEAK_FMALE_CNT}
		, WEAK_REG_EMP_CNT		= #{p.WEAK_REG_EMP_CNT}
		, WEAK_REG_WEEK_TIME		= #{p.WEAK_REG_WEEK_TIME}
		, WEAK_REG_MONTH_PAY		= #{p.WEAK_REG_MONTH_PAY}
		, WEAK_REG_EMP_TIME		= #{p.WEAK_REG_EMP_TIME}
		, WEAK_COM_EMP_CNT		= #{p.WEAK_COM_EMP_CNT}
		, WEAK_COM_WEEK_TIME		= #{p.WEAK_COM_WEEK_TIME}
		, WEAK_COM_MONTH_PAY		= #{p.WEAK_COM_MONTH_PAY}
		, WEAK_COM_EMP_TIME		= #{p.WEAK_COM_EMP_TIME}
		, WEAK_CONTRACT_EMP_CNT		= #{p.WEAK_CONTRACT_EMP_CNT}
		, WEAK_CONTRACT_WEEK_TIME		= #{p.WEAK_CONTRACT_WEEK_TIME}
		, WEAK_CONTRACT_MONTH_PAY		= #{p.WEAK_CONTRACT_MONTH_PAY}
		, WEAK_CONTRACT_EMP_TIME		= #{p.WEAK_CONTRACT_EMP_TIME}
		, WEAK_TIME_EMP_CNT		= #{p.WEAK_TIME_EMP_CNT}
		, WEAK_TIME_WEEK_TIME		= #{p.WEAK_TIME_WEEK_TIME}
		, WEAK_TIME_MONTH_PAY		= #{p.WEAK_TIME_MONTH_PAY}
		, WEAK_TIME_EMP_TIME		= #{p.WEAK_TIME_EMP_TIME}
		, WEAK_SPE_EMP_CNT		= #{p.WEAK_SPE_EMP_CNT}
		, WEAK_SPE_WEEK_TIME		= #{p.WEAK_SPE_WEEK_TIME}
		, WEAK_SPE_MONTH_PAY		= #{p.WEAK_SPE_MONTH_PAY}
		, WEAK_SPE_EMP_TIME		= #{p.WEAK_SPE_EMP_TIME}
		, WEAK_VOL_EMP_CNT		= #{p.WEAK_VOL_EMP_CNT}
		, WEAK_VOL_WEEK_TIME		= #{p.WEAK_VOL_WEEK_TIME}
		, WEAK_AVG_YEAR		= #{p.WEAK_AVG_YEAR}
		, WEAK_TYPE1_CNT		= #{p.WEAK_TYPE1_CNT}
		, WEAK_TYPE2_CNT		= #{p.WEAK_TYPE2_CNT}
		, WEAK_TYPE3_CNT		= #{p.WEAK_TYPE3_CNT}
		, WEAK_TYPE4_CNT		= #{p.WEAK_TYPE4_CNT}
		, WEAK_TYPE5_CNT		= #{p.WEAK_TYPE5_CNT}
		, WEAK_TYPE6_CNT		= #{p.WEAK_TYPE6_CNT}
		, WEAK_TYPE7_CNT		= #{p.WEAK_TYPE7_CNT}
		, FIRST_REASON		= #{p.FIRST_REASON}
		, SECOND_REASON		= #{p.SECOND_REASON}
		, ETC_REASON		= #{p.ETC_REASON}
		, CORP_ASSET		= #{p.CORP_ASSET}
		, CORP_CAPITAL		= #{p.CORP_CAPITAL}
		, CORP_DEBT		= #{p.CORP_DEBT}
		, CORP_SALES		= #{p.CORP_SALES}
		, CORP_SALES_PROFIT 		= #{p.CORP_SALES_PROFIT}
		, CORP_LABOR_COST		= #{p.CORP_LABOR_COST}
		, CORP_TAX		= #{p.CORP_TAX}
		, CORP_OP_PROFIT		= #{p.CORP_OP_PROFIT}
		, CORP_NET_INCOM		= #{p.CORP_NET_INCOM}
		, GOV_SUP_ASSET		= #{p.GOV_SUP_ASSET}
		, GOV_SUP_COST		= #{p.GOV_SUP_COST}
		, SPONSOR_DONATE		= #{p.SPONSOR_DONATE}
		, FUNDS_REVENUE		= #{p.FUNDS_REVENUE}
		, FUNDS_DONATE		= #{p.FUNDS_DONATE}
		, FUNDS_SUPP		= #{p.FUNDS_SUPP}
		, FUNDS_LOAN		= #{p.FUNDS_LOAN}
		, FUNDS_ETC		= #{p.FUNDS_ETC}
		, MOD_ID            = #{u.userId}
		, MOD_DT            = now()
		WHERE CORP_SEQ = #{p.CORP_SEQ}
	</update>

	<delete id="deleteSocialInfo">
		DELETE FROM CORP_INFO_SE
		WHERE CORP_SEQ = #{CORP_SEQ}
	</delete>















	<!-- 월간실적(비용현황)-->
	<select id="findCosts" resultType="hashmap">
		SELECT Y.YEAR
			 , Y.MONTH
			 , SUM(IFNULL(C.FOOD_MATERIAL       , 0)) AS FOOD_MATERIAL
			 , SUM(IFNULL(C.LABOR               , 0)) AS LABOR
			 , SUM(IFNULL(C.MANAGEMENT          , 0)) AS MANAGEMENT
			 , SUM(IFNULL(C.DEPRECIATION        , 0)) AS DEPRECIATION
			 , SUM(IFNULL(C.NON_SALES           , 0)) AS NON_SALES
			 , SUM(IFNULL(C.RETIRE_SAVING       , 0)) AS RETIRE_SAVING
			 , SUM(IFNULL(C.INDEPENDENCY_SAVING , 0)) AS INDEPENDENCY_SAVING
		 FROM M_COSTS AS C
   RIGHT JOIN YM AS Y ON (
                             C.YEAR = Y.YEAR AND
                             C.MONTH = Y.MONTH)
		WHERE Y.YEAR = #{p.YEAR}
	GROUP BY Y.YEAR, Y.MONTH
	</select>

	<!-- 월간실적(고용현황)-->
	<select id="findEmployment" resultType="hashmap">
		SELECT Y.YEAR
			  , Y.MONTH
			  , SUM(IFNULL(E.GENERAL_MALE         , 0)) AS GENERAL_MALE
			  , SUM(IFNULL(E.GENERAL_FEMALE       , 0)) AS GENERAL_FEMALE
			  , SUM(IFNULL(E.GOV_MALE             , 0)) AS GOV_MALE
			  , SUM(IFNULL(E.GOV_FEMALE           , 0)) AS GOV_FEMALE
			  , SUM(IFNULL(E.SELF_SUPPORT_MALE    , 0)) AS SELF_SUPPORT_MALE
			  , SUM(IFNULL(E.SELF_SUPPORT_FEMALE  , 0)) AS SELF_SUPPORT_FEMALE
			  , SUM(IFNULL(E.ROLE_CEO             , 0)) AS ROLE_CEO
			  , SUM(IFNULL(E.ROLE_DIETITION       , 0)) AS ROLE_DIETITION
			  , SUM(IFNULL(E.ROLE_MANAGER         , 0)) AS ROLE_MANAGER
			  , SUM(IFNULL(E.ROLE_GENERAL_AFFAIRS , 0)) AS ROLE_GENERAL_AFFAIRS
			  , SUM(IFNULL(E.ROLE_COOK            , 0)) AS ROLE_COOK
			  , SUM(IFNULL(E.ROLE_DELIVERY_DRIVER , 0)) AS ROLE_DELIVERY_DRIVER
			  , SUM(IFNULL(E.ROLE_DELIVERY_LABOR  , 0)) AS ROLE_DELIVERY_LABOR
			  , SUM(IFNULL(E.ROLE_ETC             , 0)) AS ROLE_ETC
		 FROM M_EMPLOYMENT AS E
   RIGHT JOIN YM AS Y ON (
                              E.YEAR = Y.YEAR
                              AND E.MONTH = Y.MONTH)
		WHERE Y.YEAR = #{p.YEAR}
	 GROUP BY Y.YEAR, Y.MONTH
	</select>

	<!-- 월간실적(수입현황-유료급식)-->
	<select id="findIncomePaidMeals" resultType="hashmap">
		SELECT Y.YEAR
			  , Y.MONTH
			  , SUM(IFNULL(PA.LUNCH_BOX     , 0)) AS LUNCH_BOX
			  , SUM(IFNULL(PA.CATERING      , 0)) AS CATERING
			  , SUM(IFNULL(PA.RESERVE_FORCES, 0)) AS RESERVE_FORCES
			  , SUM(IFNULL(PA.SCHOOL        , 0)) AS SCHOOL
			  , SUM(IFNULL(PA.LUNCH_ROOM    , 0)) AS LUNCH_ROOM
			  , SUM(IFNULL(PA.SPECIALTY     , 0)) AS SPECIALTY
			  , SUM(IFNULL(PA.HYNIX_SUPPORT , 0)) AS HYNIX_SUPPORT
			  , SUM(IFNULL(PA.ETC           , 0)) AS ETC
		 FROM M_INCOME_PAID_MEALS AS PA
   RIGHT JOIN YM AS Y ON (
                              PA.YEAR = Y.YEAR
                              AND PA.MONTH = Y.MONTH)
		WHERE Y.YEAR = #{p.YEAR}
	 GROUP BY Y.YEAR, Y.MONTH
	</select>

	<!-- 월간실적(수입현황-공공급식)-->
	<select id="findIncomePublicMeals" resultType="hashmap">
		SELECT Y.YEAR
			  , Y.MONTH
			  , SUM(IFNULL(PU.KIDS_LUNCH_BOX         , 0)) AS KIDS_LUNCH_BOX
			  , SUM(IFNULL(PU.KIDS_LUNCH_CAR         , 0)) AS KIDS_LUNCH_CAR
			  , SUM(IFNULL(PU.SILVER_LUNCH_BOX       , 0)) AS SILVER_LUNCH_BOX
			  , SUM(IFNULL(PU.SILVER_SIDE_DISH       , 0)) AS SILVER_SIDE_DISH
			  , SUM(IFNULL(PU.SILVER_LUNCH_ROOM      , 0)) AS SILVER_LUNCH_ROOM
			  , SUM(IFNULL(PU.ETC                    , 0)) AS ETC
			  , SUM(IFNULL(PU.SALES_KIDS_LUNCH_BOX   , 0)) AS SALES_KIDS_LUNCH_BOX
			  , SUM(IFNULL(PU.SALES_KIDS_LUNCH_CAR   , 0)) AS SALES_KIDS_LUNCH_CAR
			  , SUM(IFNULL(PU.SALES_SILVER_LUNCH_BOX , 0)) AS SALES_SILVER_LUNCH_BOX
			  , SUM(IFNULL(PU.SALES_SILVER_SIDE_DISH , 0)) AS SALES_SILVER_SIDE_DISH
			  , SUM(IFNULL(PU.SALES_SILVER_LUNCH_ROOM, 0)) AS SALES_SILVER_LUNCH_ROOM
			  , SUM(IFNULL(PU.SALES_ETC              , 0)) AS SALES_ETC
			  , SUM(IFNULL(PU.SELF_PAY               , 0)) AS SELF_PAY
		 FROM M_INCOME_PUBLIC_MEALS AS PU
   RIGHT JOIN YM AS Y ON (
                             PU.YEAR = Y.YEAR
                             AND PU.MONTH = Y.MONTH)
		WHERE Y.YEAR = #{p.YEAR}
		GROUP BY Y.YEAR, Y.MONTH
	</select>

	<!-- 월간실적(지원금)-->
	<select id="findIncomeSupport" resultType="hashmap">
		SELECT Y.YEAR
			  , Y.MONTH
			  , SUM(IFNULL(SU.GOV_LABOR_COSTS       , 0)) AS GOV_LABOR_COSTS
			  , SUM(IFNULL(SU.GOV_BIZ_DEVELOPMENT   , 0)) AS GOV_BIZ_DEVELOPMENT
			  , SUM(IFNULL(SU.GOV_MANAGEMENT        , 0)) AS GOV_MANAGEMENT
			  , SUM(IFNULL(SU.GOV_ETC               , 0)) AS GOV_ETC
			  , SUM(IFNULL(SU.GOV_NOTE              , 0)) AS GOV_NOTE
			  , SUM(IFNULL(SU.EXT_DONATION          , 0)) AS EXT_DONATION
			  , SUM(IFNULL(SU.EXT_FOUNDATION_SUPPORT, 0)) AS EXT_FOUNDATION_SUPPORT
			  , SUM(IFNULL(SU.EXT_ETC               , 0)) AS EXT_ETC
		 FROM M_INCOME_SUPPORT AS SU
   RIGHT JOIN YM AS Y ON (
                             SU.YEAR = Y.YEAR
                             AND SU.MONTH = Y.MONTH)
		WHERE Y.YEAR = #{p.YEAR}
	 GROUP BY Y.YEAR, Y.MONTH
	</select>

	<!-- 월간실적(사회적공헌)-->
	<select id="findDonation" resultType="hashmap">
		SELECT Y.YEAR
			 , Y.MONTH
			 , '-'                            AS NAME
			 , '-'							  AS TARGET
			 , SUM(IFNULL(DN.REQ_PERSON , 0)) AS REQ_PERSON
			 , SUM(IFNULL(DN.REQ_TIME   , 0)) AS REQ_TIME
			 , SUM(IFNULL(DN.REQ_AMT    , 0)) AS REQ_AMT
			 , SUM(IFNULL(DN.TOTAL_AMT  , 0)) AS TOTAL_AMT
		FROM M_DONATION AS DN
		RIGHT JOIN YM AS Y ON (
								    DN.YEAR = Y.YEAR
								AND DN.MONTH = Y.MONTH)
		WHERE Y.YEAR = #{p.YEAR}
	 GROUP BY Y.YEAR, Y.MONTH
	</select>

	<!-- 월간 실적 - 월평균 임금 -->
	<select id="findSalary" resultType="hashmap">
		SELECT
		YEAR
		, AVG(LABOR) SALARY_AVG
		FROM M_COSTS
		WHERE YEAR = #{p.YEAR}
		GROUP BY YEAR
	</select>

	<!-- 월간 운영현황 -->
	<select id="findMonthlyOperationStatus" resultType="hashmap">
		SELECT
		YEAR
		, MONTH
		, SUMMARY_TOTAL_SALES      /* 총매출 */
		, PUBLIC_TOTAL_SALES       /* 공공 급식 매출 */
		, PAID_TOTAL_SALES         /* 유료 급식 매출 */
		, SUMMARY_OP_PROFIT        /* 영업이익 */
		, SUMMARY_NET_PROFIT       /* 순이익 */
		, SUMMARY_INDEPEND_POWER_A /* 자립도_A */
		, SUMMARY_INDEPEND_POWER_B /* 자립도_B */
		, SUMMARY_EMP_WEAK_RATE    /* 취약계층 고용율 */
		FROM VIEW_Y_SUMMARY
		WHERE YEAR = #{p.YEAR}
	</select>
	<!--
    /*공공급식수 */        PUBLIC_MEALS_CNT
    /*공공매출*/           PUBLIC_TOTAL_SALES
    /*공공자부담급식수*/    PUBLIC_SELF_PAY
    /*유료매출*/           PAID_TOTAL_SALES
    /*수익B-인건비*/       SUPPORT_GOV_LABOR_COSTS
    /*수익B-사업개발비*/   SUPPORT_GOV_BIZ_DEVELOPMENT
    /*수익B-운영비*/       SUPPORT_GOV_MANAGEMENT
    /*수익B-기타*/         SUPPORT_GOV_ETC
    /*수익B-합계*/         SUPPORT_GOV_TOTAL
    /*수익B-기타수입*/     SUPPORT_ETC_TOTAL
    /*비용-식재료비*/      COSTS_FOOD_MATERIAL
    /*비용-인건비*/        COSTS_LABOR
    /*비용-운영비*/        COSTS_MANAGEMENT
    /*비용-감가상각비*/     COSTS_DEPRECIATION
    /*비용-영업외비용*/     COSTS_NON_SALES
    /*비용-합계*/          COSTS_TOTAL
    /*비용-월퇴직 적립금*/  COSTS_RETIRE_SAVING
    /*비용-자립적립급*/     COSTS_INDEPENDENCY_SAVING
    /*고용-일반고용합계*/   EMP_GENERAL_SUM
    /*고용-정부지원합계*/   EMP_GOV_SUM
    /*고용-자활근로*/      EMP_SELP_SUPPORT_SUM
    /*고용-합계*/         EMP_SUM
    /*매출합계*/           SUMMARY_TOTAL_SALES
    /*영업이익*/           SUMMARY_OP_PROFIT
    /*순이익*/            SUMMARY_NET_PROFIT
    /*수익A*/             PROFIT_A
    /*수익B*/             PROFIT_B
    /*자립도A*/           SUMMARY_INDEPEND_POWER_A
    /*자립도B*/           SUMMARY_INDEPEND_POWER_B
    /*취약계층고용율*/     SUMMARY_EMP_WEAK_RATE
    -->
	<!-- 요약 1 -->
	<select id="findMonthlySummary1" resultType="hashmap">
		SELECT
		YEAR
		, MONTH
		, PUBLIC_MEALS_CNT       	            /* 공공급식수*/
		, SUMMARY_TOTAL_SALES       	            /* 총매출*/
		, PUBLIC_TOTAL_SALES         	            /* 공공 급식 매출*/
		, PAID_TOTAL_SALES        		            /* 유료 급식 매출*/
		, PAID_TOTAL_SALES / PUBLIC_MEALS_CNT * 100
							  AS PAID_TOTAL_RATE    /*유료매출 비율*/
		, PUBLIC_SELF_PAY 				            /* 자부담 급식수*/
		FROM VIEW_Y_SUMMARY
		WHERE YEAR = #{p.YEAR}
	</select>

	<!-- 요약 2 -->
	<select id="findMonthlySummary2" resultType="hashmap">
		SELECT
		YEAR
		, MONTH
		, PUBLIC_TOTAL_SALES           /*공공 급식 매출*/
		, PAID_TOTAL_SALES             /*유료 급식 매출*/
		, SUPPORT_ETC_TOTAL            /*기타 수익*/
		, COSTS_LABOR                  /*비용-인건비*/
		, COSTS_FOOD_MATERIAL          /*비용-식재료비*/
	    , COSTS_MANAGEMENT             /*비용-운영비*/
	    , COSTS_DEPRECIATION           /*비용-감가상각비*/
	    , COSTS_NON_SALES              /*비용-영업외비용*/
	    , SUPPORT_GOV_LABOR_COSTS      /*수익B-인건비*/
		, SUPPORT_GOV_BIZ_DEVELOPMENT  /*수익B-사업개발비*/
	    , SUPPORT_GOV_MANAGEMENT       /*수익B-운영비*/
	    , SUPPORT_GOV_ETC              /*수익B-기타*/
	    , COSTS_RETIRE_SAVING          /*비용-월퇴직 적립금*/
	    , COSTS_INDEPENDENCY_SAVING    /*비용-자립적립급*/
		FROM VIEW_Y_SUMMARY
		WHERE YEAR = #{p.YEAR}
	</select>

	<!-- 요약 3 -->
	<select id="findMonthlySummary3" resultType="hashmap">
		SELECT
	    YEAR
		, MONTH
		, SUMMARY_INDEPEND_POWER_A                 /*자립도A*/
	    , SUMMARY_INDEPEND_POWER_B                 /*자립도B*/
	    , PROFIT_A                                 /*수익A*/
	    , PROFIT_B                                 /*수익B*/
		, COSTS_TOTAL                              /*비용-합계*/
		, EMP_SUM                                  /*고용-합계*/
	    , SUMMARY_TOTAL_SALES                      /*매출합계*/
	    , SUMMARY_OP_PROFIT                        /*영업이익*/
	    , SUMMARY_NET_PROFIT                       /*순이익*/
	    , COSTS_LABOR / EMP_SUM AS COSTS_LABOR_AVG /*평균인건비*/
	    , COSTS_LABOR / SUMMARY_TOTAL_SALES * 100
	                  AS COSTS_LABOR_RATE          /*인건비율*/
	    , COSTS_FOOD_MATERIAL / SUMMARY_TOTAL_SALES * 100
	                          AS COSTS_FOOD_MATERIAL_RATE /*총재료비율*/
	    , SUMMARY_OP_PROFIT                               /*영업이익*/
	    , SUMMARY_NET_PROFIT                              /*순이익*/
		FROM VIEW_Y_SUMMARY
		WHERE YEAR = #{p.YEAR}
	</select>

	<!-- 요약 4 -->
	<select id="findMonthlySummary4" resultType="hashmap">
		SELECT
		YEAR
		, MONTH
		, EMP_GENERAL_SUM                        /*일반고용*/
	    , IFNULL(EMP_GENERAL_SUM        / EMP_SUM * 100, 0)
	                         AS EMP_GENERAL_RATE /*일반고용비율*/
	    , EMP_GOV_SUM                            /*고용-노동부*/
	    , IFNULL(EMP_GOV_SUM           / EMP_SUM * 100, 0)
	                              AS EMP_GOVRATE /*고용-노동부비율*/
	    , EMP_SELF_SUPPORT_SUM                   /*고용-자활근로*/
	    , IFNULL(EMP_SELF_SUPPORT_SUM  / EMP_SUM * 100, 0)
	                    AS EMP_SELF_SUPPORT_RATE /*고용-자활근로*/
	    , EMP_SUM                                /*고용-합계*/
	    , EMP_WEAK_SUM							 /*취약계층*/
	    , IFNULL(EMP_WEAK_SUM         / EMP_SUM * 100, 0)
	                           AS EMP_WEAK_RATE  /*취약게층*/
	    , EMP_FEMALE_SUM                         /*여성*/
	    , IFNULL(EMP_FEMALE_SUM       / EMP_SUM * 100, 0)
	                          AS EMP_FEMALE_RATE /*여성비율*/
		FROM VIEW_Y_SUMMARY
		WHERE YEAR = #{p.YEAR}
	</select>
	<!-- 연간실적 필요없음-->

	<!--//////////////////////// -->
	<!-- 전체 센터 성과지표 조회, CORP_SEQ 로 서비스에서 피벗팅 함 -->
	<select id="findAllCorpKpiByYear" resultType="hashmap">
		SELECT
		BK.CORP_SEQ
		, BK.YEAR
		, BK.L1_KPI_NM
		, BK.L2_KPI_NM
		, BK.L3_KPI_NM
		, BK.L3_KPI_CD
		, NULL AS STATUS
		FROM VIEW_CORP_YEAR_KPI BK
		LEFT JOIN Y_MANUAL_KPI MK ON (BK.CORP_SEQ = MK.CORP_SEQ AND BK.YEAR = MK.YEAR AND BK.L3_KPI_CD = MK.KPI_CD)
		WHERE BK.YEAR = #{p.YEAR}
		ORDER BY BK.YEAR, BK.L3_KPI_CD, BK.CORP_SEQ
	</select>

	<!-- CORP_SEQ로 피벗하기 때문에 CORP_INFO 정보도 같이 내려준다.-->
	<select id="findAllCorpKpiByYear_corpInfo" resultType="hashmap">
		SELECT
		CORP_SEQ
		, CENTER_NM
		FROM CORP_INFO
	   WHERE USE_YN = 'Y'
	</select>

</mapper>
