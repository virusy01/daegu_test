<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="snp.app.corp.CorpRepository">

	<!-- 사회적기업 성과지표 조회 -->
	<select id="findSocialKpi" resultType="hashmap">
		SELECT
		L1.KPI_CD AS L1_KPI_CD
		, L1.KPI_NM AS L1_KPI_NM
		, L2.KPI_CD AS L2_KPI_CD
		, L2.KPI_NM AS L2_KPI_NM
		, L3.KPI_CD AS L3_KPI_CD
		, L3.KPI_NM AS L3_KPI_NM
		, L3.IS_GRADE AS IS_GRADE
		, #{p.CORP_SEQ} AS CORP_SEQ
		, #{p.YEAR} AS YEAR
		, null        AS STATUS
		FROM
		(
		SELECT * FROM SOCIAL_KPI WHERE LEVEL = 1
		) L1
		INNER JOIN
		(
		SELECT * FROM SOCIAL_KPI WHERE LEVEL = 2
		) L2 ON (L1.KPI_CD = L2.P_KPI_CD)
		INNER JOIN
		(
		SELECT * FROM SOCIAL_KPI WHERE LEVEL = 3
		) L3 ON (L2.KPI_CD = L3.P_KPI_CD)
		ORDER BY L3.LEVEL, L3.DISP_ORD

	</select>


    <!-- 사회적기업 성과지표 입력 -->
	<insert id="insertKpi">
		INSERT INTO KPI_RESULT
		(
		CORP_SEQ
		, CORP_TYPE
		, YEAR
		, KPI_CD
		, IS_GRADE
		, RESULT
		, REG_ID
		, REG_DT
		)
		VALUES
		(
		#{p.CORP_SEQ}
		, #{p.CORP_TYPE}
		, #{p.YEAR}
		, #{p.KPI_CD}
		, #{p.IS_GRADE}
		, #{p.RESULT}
		, #{u.userId}
		, now()
		)
	</insert>

    <!-- 사회적기업 성과지표 삭제 -->
	<delete id="deleteKpi">
		DELETE FROM  KPI_RESULT
		WHERE CORP_SEQ = #{p.CORP_SEQ} AND CORP_TYPE = #{p.CORP_TYPE} AND YEAR = #{p.YEAR}
	</delete>



    <!-- 전체기업 성과지표 데이터 조회 -->
	<select id="findKpi_detail" resultType="hashmap">
		<![CDATA[
		SELECT
		RESULT AS RESULT
		, CORP_NM
		FROM KPI_RESULT
		WHERE CORP_SEQ = #{p.CORP_SEQ}
		  AND YEAR = #{p.YEAR} AND KPI_CD = #{LEVEL3CODE}
		]]>
	</select>

	<!-- 협동조합 성과지표 조회 -->
	<select id="findCooperationKpi" resultType="hashmap">
		SELECT
		L1.KPI_CD AS L1_KPI_CD
		, L1.KPI_NM AS L1_KPI_NM
		, L2.KPI_CD AS L2_KPI_CD
		, L2.KPI_NM AS L2_KPI_NM
		, L3.KPI_CD AS L3_KPI_CD
		, L3.KPI_NM AS L3_KPI_NM
		, L3.IS_GRADE AS IS_GRADE
		, #{p.CORP_SEQ} AS CORP_SEQ
		, #{p.YEAR} AS YEAR
		, null        AS STATUS
		FROM
		(
		SELECT * FROM COOPERATION_KPI WHERE LEVEL = 1
		) L1
		INNER JOIN
		(
		SELECT * FROM COOPERATION_KPI WHERE LEVEL = 2
		) L2 ON (L1.KPI_CD = L2.P_KPI_CD)
		INNER JOIN
		(
		SELECT * FROM COOPERATION_KPI WHERE LEVEL = 3
		) L3 ON (L2.KPI_CD = L3.P_KPI_CD)
		ORDER BY L3.LEVEL, L3.DISP_ORD

	</select>


	<!-- 마을기업 성과지표 조회 -->
	<select id="findVillageKpi" resultType="hashmap">
		SELECT
		L1.KPI_CD AS L1_KPI_CD
		, L1.KPI_NM AS L1_KPI_NM
		, L2.KPI_CD AS L2_KPI_CD
		, L2.KPI_NM AS L2_KPI_NM
		, L3.KPI_CD AS L3_KPI_CD
		, L3.KPI_NM AS L3_KPI_NM
		, L3.IS_GRADE AS IS_GRADE
		, #{p.CORP_SEQ} AS CORP_SEQ
		, #{p.YEAR} AS YEAR
		, null        AS STATUS
		FROM
		(
		SELECT * FROM VILLAGE_KPI WHERE LEVEL = 1
		) L1
		INNER JOIN
		(
		SELECT * FROM VILLAGE_KPI WHERE LEVEL = 2
		) L2 ON (L1.KPI_CD = L2.P_KPI_CD)
		INNER JOIN
		(
		SELECT * FROM VILLAGE_KPI WHERE LEVEL = 3
		) L3 ON (L2.KPI_CD = L3.P_KPI_CD)
		ORDER BY L3.LEVEL, L3.DISP_ORD

	</select>




	<!-- 성과지표 등급별 분석 - 등급항목별 - 전체기업-->
	<select id="chartGrade1Grade" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND RESULT in ('1', '2')
		UNION ALL
		SELECT 'W' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND RESULT in ('3', '4', '5')
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND RESULT in ('6', '7')
	</select>

	<!-- 성과지표 등급별 분석 등급항목별- 사회적기업 -->
	<select id="chartGrade2Grade" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 1 AND RESULT in ('1', '2')
		UNION ALL
		SELECT 'W' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 1 AND RESULT in ('3', '4', '5')
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 1 AND RESULT in ('6', '7')
	</select>

	<!-- 성과지표 등급별 분석 등급항목별- 마을기업 -->
	<select id="chartGrade3Grade" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 2 AND RESULT in ('1', '2')
		UNION ALL
		SELECT 'W' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 2 AND RESULT in ('3', '4', '5')
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 2 AND RESULT in ('6', '7')
	</select>

	<!-- 성과지표 등급별 분석 등급항목별- 협동조합-->
	<select id="chartGrade4Grade" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 3 AND RESULT in ('1', '2')
		UNION ALL
		SELECT 'W' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 3 AND RESULT in ('3', '4', '5')
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 3 AND RESULT in ('6', '7')
	</select>






	<!-- 성과지표 등급별 분석 비율항목별 - 전체기업-->
	<select id="chartGrade1Rate" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND RESULT AND 50 >= RESULT
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND RESULT > 50
	</select>

	<!-- 성과지표 등급별 분석 등급항목별- 사회적기업 -->
	<select id="chartGrade2Rate" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = 1 AND 50 >= RESULT
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = 1 AND RESULT > 50
	</select>

	<!-- 성과지표 등급별 분석 등급항목별- 마을기업 -->
	<select id="chartGrade3Rate" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = 2 AND  50 >= RESULT
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = 2 AND  RESULT > 50
	</select>

	<!-- 성과지표 등급별 분석 등급항목별- 협동조합-->
	<select id="chartGrade4Rate" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = 3 AND  50 = RESULT
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = 3 AND RESULT > 50
	</select>







	<!-- 성과지표 1단계 항목별  분석 등급항목 -  전체기업-->
	<select id="chartKpiAllGrade" resultType="hashmap">
	  SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
	  FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND (KPI_CD like '0101%' OR KPI_CD like '0102%') AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

      SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
	  FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL


		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND KPI_CD like '02%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

			 SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND KPI_CD like '03%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

			 SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND KPI_CD like '04%' AND ( RESULT >= 1 AND 7 >= RESULT )
	</select>

	<!-- 성과지표 1단계 항목별 분석 등급항목 - 사회적기업,마을기업,협동조합-->
	<select id="chartKpiEachGrade" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}	AND (KPI_CD like '0101%' OR KPI_CD like '0102%') AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

				SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '02%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '03%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '04%' AND ( RESULT >= 1 AND 7 >= RESULT )
	</select>

	<!-- 성과지표 1단계 항목별  분석 비율항목 -  전체기업-->
	<select id="chartKpiAllRate" resultType="hashmap">
	  SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
	  FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
			 AND KPI_CD like '0104%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

      SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
	  FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
			 AND KPI_CD like '0104%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 2  AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 0 AND 100 >= RESULT )
	</select>

	<!-- 성과지표 1단계 항목별 분석 비율항목 - 사회적기업,마을기업,협동조합-->
	<select id="chartKpiEachRate" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0104%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0104%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '02%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '03%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '04%' AND ( RESULT >= 0 AND 100 >= RESULT )
	</select>








    <!-- 성과지표 2단계 항목별  분석 등급항목 -  전체기업-->
    <select id="chartKpiDetailAllGrade" resultType="hashmap">
        SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0101%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0102%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0201%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0301%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0401%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 6 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0402%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 7 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0403%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 8 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0404%' AND ( RESULT >= 1 AND 7 >= RESULT )

    </select>

    <!-- 성과지표 2단계 항목별 분석 등급항목 - 사회적기업,마을기업,협동조합-->
    <select id="chartKpiDetailEachGrade" resultType="hashmap">
        SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0101%'  AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0102%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0201%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0301%' AND ( RESULT >= 1 AND 7 >= RESULT )

         UNION ALL

        SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0401%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 6 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0402%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 7 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0403%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 8 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0404%' AND ( RESULT >= 1 AND 7 >= RESULT )



    </select>

    <!-- 성과지표 2단계 항목별  분석 비율항목 -  전체기업-->
    <select id="chartKpiDetailAllRate" resultType="hashmap">
       SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND KPI_CD like '0104%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND KPI_CD like '0202%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND KPI_CD like '0302%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND KPI_CD like '0303%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND KPI_CD like '0405%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND KPI_CD like '0406%' AND ( RESULT >= 0 AND 100 >= RESULT )
    </select>

    <!-- 성과지표 2단계 항목별 분석 비율항목 - 사회적기업,마을기업,협동조합-->
    <select id="chartKpiDetailEachRate" resultType="hashmap">
        SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0104%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0202%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0302%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0303%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0405%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0406%' AND ( RESULT >= 0 AND 100 >= RESULT )
    </select>









	<!-- 성과지표 지역별 분석 등급항목 전체 -->
	<select id="chartRegionAllGrade" resultType="hashmap">
	SELECT FOUR.CD AS REGION, IFNULL(THR.RESULT,0) AS RESULT
	FROM
		(SELECT SEC.REGION AS REGION, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
			SELECT CORP_SEQ, RESULT FROM KPI_RESULT
			WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
			OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
			OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0  AND SEC.REGION IS NOT NULL
  		GROUP BY REGION) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='REGION' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.REGION )
  		ORDER BY RESULT DESC
	</select>

	<!-- 성과지표 지역별 분석 등급항목 - 사회적기업,마을기업,협동조합 -->
	<select id="chartRegionEachGrade" resultType="hashmap">
	SELECT FOUR.CD AS REGION, IFNULL(THR.RESULT,0) AS RESULT
	FROM
		(SELECT SEC.REGION AS REGION, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
			SELECT CORP_SEQ, RESULT FROM KPI_RESULT
			WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
			OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
			OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = #{p.CORP_KIND}
			) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0  AND SEC.REGION IS NOT NULL
		GROUP BY REGION) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='REGION' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.REGION )
		ORDER BY RESULT DESC
	</select>

	<!-- 성과지표 지역별 분석 비율항목 전체 -->
	<select id="chartRegionAllRate" resultType="hashmap">
		SELECT FOUR.CD AS REGION, IFNULL(THR.RESULT,0) AS RESULT
		FROM
		(SELECT SEC.REGION AS REGION, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0  AND SEC.REGION IS NOT NULL
		GROUP BY REGION) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='REGION' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.REGION )
		ORDER BY RESULT DESC
	</select>

	<!-- 성과지표 지역별 분석 비율항목 - 사회적기업,마을기업,협동조합 -->
	<select id="chartRegionEachRate" resultType="hashmap">
		SELECT FOUR.CD AS REGION, IFNULL(THR.RESULT,0) AS RESULT
		FROM
		(SELECT SEC.REGION AS REGION, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0  AND SEC.REGION IS NOT NULL
		GROUP BY REGION) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='REGION' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.REGION )
		ORDER BY RESULT	 DESC
	</select>






    <!-- 성과지표 업종별 분석 등급항목별 전체-->
    <select id="chartSectorAllGrade" resultType="hashmap">
    SELECT FOUR.CD AS SECTOR, IFNULL(THR.RESULT,0) AS RESULT
        FROM
            (SELECT SEC.SECTOR AS SECTOR, ROUND(AVG(FIR.RESULT),1) AS RESULT
            FROM
            (
                SELECT CORP_SEQ, RESULT FROM KPI_RESULT
                WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
                OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
                OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
                ) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
            WHERE FIR.RESULT != 0  AND SEC.SECTOR IS NOT NULL
            GROUP BY SECTOR) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='SECTOR' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.SECTOR )
            ORDER BY RESULT DESC
    </select>



    <!-- 성과지표 업종별 분석 등급항목별 - 사회적기업,마을기업,협동조합 -->
    <select id="chartSectorEachGrade" resultType="hashmap">
    SELECT FOUR.CD AS SECTOR, IFNULL(THR.RESULT,0) AS RESULT
        FROM
            (SELECT SEC.SECTOR AS SECTOR, ROUND(AVG(FIR.RESULT),1) AS RESULT
            FROM
            (
                SELECT CORP_SEQ, RESULT FROM KPI_RESULT
                WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
                OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
                OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
                 AND CORP_TYPE = #{p.CORP_KIND}
                ) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
            WHERE FIR.RESULT != 0  AND SEC.SECTOR IS NOT NULL
            GROUP BY SECTOR) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='SECTOR' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.SECTOR )
            ORDER BY RESULT DESC
    </select>



	<!-- 성과지표 업종별 분석 비율항목별 전체-->
	<select id="chartSectorAllRate" resultType="hashmap">
		SELECT FOUR.CD AS SECTOR, IFNULL(THR.RESULT,0) AS RESULT
		FROM
		(SELECT SEC.SECTOR AS SECTOR, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0  AND SEC.SECTOR IS NOT NULL
		GROUP BY SECTOR) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='SECTOR' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.SECTOR )
		ORDER BY RESULT DESC
	</select>

	<!-- 성과지표 업종별 분석 비율항목별 - 사회적기업,마을기업,협동조합 -->
	<select id="chartSectorEachRate" resultType="hashmap">
		SELECT FOUR.CD AS SECTOR, IFNULL(THR.RESULT,0) AS RESULT
		FROM
		(SELECT SEC.SECTOR AS SECTOR, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0  AND SEC.SECTOR IS NOT NULL
		GROUP BY SECTOR) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='SECTOR' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.SECTOR )
		ORDER BY RESULT DESC
	</select>








	<!-- 성과지표 사회적경제조직 유형별 분석 - 등급항목 통계 전체기업-->
	<select id="chartAllGradeTotal" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND (KPI_CD like '0101%' OR KPI_CD like '0102%') AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND ( RESULT >= 1 AND 7 >= RESULT )
	</select>

	<!-- 성과지표 사회적경제조직 유형별 분석 - 등급항목 통계 사회적기업-->
	<select id="chartAllGradeSocial" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND (KPI_CD like '0101%' OR KPI_CD like '0102%') AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 1
	</select>

	<!-- 성과지표 사회적경제조직 유형별 분석 - 등급항목 통계 마을기업-->
	<select id="chartAllGradeVillage" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND (KPI_CD like '0101%' OR KPI_CD like '0102%') AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 2
	</select>


	<!-- 성과지표 사회적경제조직 유형별 분석 - 등급항목 통계 협동조합-->
	<select id="chartAllGradeCooperation" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND  (KPI_CD like '0101%' OR KPI_CD like '0102%')  AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 3
	</select>

	<!-- 성과지표 사회적경제조직 유형별 분석 - 비율항목 통계 전체기업-->
	<select id="chartAllRateTotal" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND ( RESULT >= 0 AND 100 >= RESULT )
	</select>

	<!-- 성과지표 사회적경제조직 유형별 분석 - 비율항목 통계 사회적기업-->
	<select id="chartAllRateSocial" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 1
	</select>

	<!-- 성과지표 사회적경제조직 유형별 분석 - 비율항목 통계 마을기업-->
	<select id="chartAllRateVillage" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 2
	</select>


	<!-- 성과지표 사회적경제조직 유형별 분석 - 비율항목 통계 협동조합-->
	<select id="chartAllRateCooperation" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 3
	</select>






    <!-- 성과지표 기업별 분석 전체-->
    <select id="gridCorpAll" resultType="hashmap">
	SELECT
		CASE VCK.CORP_TYPE WHEN 1 THEN '사회적기업'
		WHEN 2 THEN '마을기업'
		ELSE '협동조합' END AS CORP_TYPE,
		VCK.CORP_SEQ,
		(SELECT CORP_NM FROM CORP_INFO WHERE CORP_SEQ = VCK.CORP_SEQ) AS CORP_NM,
		SUM(CASE WHEN KPI_TYPE = '01' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_01,
		SUM(CASE WHEN KPI_TYPE = '02' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_02,
		SUM(CASE WHEN KPI_TYPE = '03' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_03,
		SUM(CASE WHEN KPI_TYPE = '04' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_04,
		SUM(CASE WHEN KPI_TYPE = '05' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_05,
		SUM(CASE WHEN KPI_TYPE = 'GRADE_TOT' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_GRADE_TOT,
		SUM(CASE WHEN KPI_TYPE = 'RATE_TOT' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_RATE_TOT
	FROM VIEW_CORP_KPI AS VCK
	GROUP BY CORP_SEQ
	ORDER BY VCK.CORP_SEQ
    </select>



    <!-- 성과지표 기업별 분석 사회적기업/마을기업/협동조합-->
    <select id="gridCorpEach" resultType="hashmap">
	SELECT
		CASE VCK.CORP_TYPE WHEN 1 THEN '사회적기업'
		WHEN 2 THEN '마을기업'
		ELSE '협동조합' END AS CORP_TYPE,
		VCK.CORP_SEQ,
		(SELECT CORP_NM FROM CORP_INFO WHERE CORP_SEQ = VCK.CORP_SEQ) AS CORP_NM,
		SUM(CASE WHEN KPI_TYPE = '01' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_01,
		SUM(CASE WHEN KPI_TYPE = '02' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_02,
		SUM(CASE WHEN KPI_TYPE = '03' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_03,
		SUM(CASE WHEN KPI_TYPE = '04' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_04,
		SUM(CASE WHEN KPI_TYPE = '05' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_05,
		SUM(CASE WHEN KPI_TYPE = 'GRADE_TOT' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_GRADE_TOT,
		SUM(CASE WHEN KPI_TYPE = 'RATE_TOT' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_RATE_TOT
	FROM VIEW_CORP_KPI AS VCK
	WHERE VCK.CORP_TYPE = #{p.CORP_KIND}
	GROUP BY CORP_SEQ
	ORDER BY VCK.CORP_SEQ
    </select>








	<!-- 성과지표 사회적목적 유형별 분석 - 등급항목 통계  : 노동통합형, 문제해결형, 지역사회혁신형, 고용창출형 -->
	<select id="chartTypeGrade" resultType="hashmap">
		SELECT FOUR.CD AS TYPE, IFNULL(THR.RESULT,0) AS RESULT
        FROM
            (SELECT SEC.LEG_TYPE2 AS LEG_TYPE2, ROUND(AVG(FIR.RESULT),1) AS RESULT
            FROM
            (
                SELECT CORP_SEQ, RESULT FROM KPI_RESULT
                WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
                OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
                OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
                ) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
			WHERE FIR.RESULT != 0  AND SEC.LEG_TYPE2 IS NOT NULL
			GROUP BY LEG_TYPE2) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='LEG_TYPE2' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.LEG_TYPE2 )
			ORDER BY RESULT DESC
	</select>

	<!-- 성과지표 사회적목적 유형별 분석 - 비율항목 통계  : 노동통합형, 문제해결형, 지역사회혁신형, 고용창출형 -->
	<select id="chartTypeRate" resultType="hashmap">
		SELECT FOUR.CD AS TYPE, IFNULL(THR.RESULT,0) AS RESULT
		FROM
		(SELECT SEC.LEG_TYPE2 AS LEG_TYPE2, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0  AND SEC.LEG_TYPE2 IS NOT NULL
		GROUP BY LEG_TYPE2) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='LEG_TYPE2' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.LEG_TYPE2 )
		ORDER BY RESULT DESC
	</select>





</mapper>
