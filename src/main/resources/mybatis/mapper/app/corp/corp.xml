<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="snp.app.corp.CorpRepository">

	<!-- 사회적기업 성과지표 조회 -->
	<select id="findSocialKpi" resultType="hashmap">
		SELECT
		L1.KPI_CD AS L1_KPI_CD
		, L1.KPI_NM AS L1_KPI_NM
		, L2.KPI_CD AS L2_KPI_CD
		, L2.KPI_NM AS L2_KPI_NM
		, L3.KPI_CD AS L3_KPI_CD
		, L3.KPI_NM AS L3_KPI_NM
		, L3.IS_GRADE AS IS_GRADE
		, #{p.CORP_SEQ} AS CORP_SEQ
		, #{p.YEAR} AS YEAR
		, null        AS STATUS
		FROM
		(
		SELECT * FROM SOCIAL_KPI WHERE LEVEL = 1
		) L1
		INNER JOIN
		(
		SELECT * FROM SOCIAL_KPI WHERE LEVEL = 2
		) L2 ON (L1.KPI_CD = L2.P_KPI_CD)
		INNER JOIN
		(
		SELECT * FROM SOCIAL_KPI WHERE LEVEL = 3
		) L3 ON (L2.KPI_CD = L3.P_KPI_CD)
		ORDER BY L3.LEVEL, L3.DISP_ORD

	</select>


    <!-- 사회적기업 성과지표 입력 -->
	<insert id="insertKpi">
		INSERT INTO KPI_RESULT
		(
		CORP_SEQ
		, CORP_TYPE
		, YEAR
		, KPI_CD
		, IS_GRADE
		, RESULT
		, REG_ID
		, REG_DT
		)
		VALUES
		(
		#{p.CORP_SEQ}
		, #{p.CORP_TYPE}
		, #{p.YEAR}
		, #{p.KPI_CD}
		, #{p.IS_GRADE}
		, #{p.RESULT}
		, #{u.userId}
		, now()
		)
	</insert>

    <!-- 사회적기업 성과지표 삭제 -->
	<delete id="deleteKpi">
		DELETE FROM  KPI_RESULT
		WHERE CORP_SEQ = #{p.CORP_SEQ} AND CORP_TYPE = #{p.CORP_TYPE} AND YEAR = #{p.YEAR}
	</delete>



    <!-- 전체기업 성과지표 데이터 조회 -->
	<select id="findKpi_detail" resultType="hashmap">
		<![CDATA[
		SELECT
		RESULT AS RESULT
		, CORP_NM
		FROM KPI_RESULT
		WHERE CORP_SEQ = #{p.CORP_SEQ}
		  AND YEAR = #{p.YEAR} AND KPI_CD = #{LEVEL3CODE}
		]]>
	</select>

	<!-- 협동조합 성과지표 조회 -->
	<select id="findCooperationKpi" resultType="hashmap">
		SELECT
		L1.KPI_CD AS L1_KPI_CD
		, L1.KPI_NM AS L1_KPI_NM
		, L2.KPI_CD AS L2_KPI_CD
		, L2.KPI_NM AS L2_KPI_NM
		, L3.KPI_CD AS L3_KPI_CD
		, L3.KPI_NM AS L3_KPI_NM
		, L3.IS_GRADE AS IS_GRADE
		, #{p.CORP_SEQ} AS CORP_SEQ
		, #{p.YEAR} AS YEAR
		, null        AS STATUS
		FROM
		(
		SELECT * FROM COOPERATION_KPI WHERE LEVEL = 1
		) L1
		INNER JOIN
		(
		SELECT * FROM COOPERATION_KPI WHERE LEVEL = 2
		) L2 ON (L1.KPI_CD = L2.P_KPI_CD)
		INNER JOIN
		(
		SELECT * FROM COOPERATION_KPI WHERE LEVEL = 3
		) L3 ON (L2.KPI_CD = L3.P_KPI_CD)
		ORDER BY L3.LEVEL, L3.DISP_ORD

	</select>


	<!-- 마을기업 성과지표 조회 -->
	<select id="findVillageKpi" resultType="hashmap">
		SELECT
		L1.KPI_CD AS L1_KPI_CD
		, L1.KPI_NM AS L1_KPI_NM
		, L2.KPI_CD AS L2_KPI_CD
		, L2.KPI_NM AS L2_KPI_NM
		, L3.KPI_CD AS L3_KPI_CD
		, L3.KPI_NM AS L3_KPI_NM
		, L3.IS_GRADE AS IS_GRADE
		, #{p.CORP_SEQ} AS CORP_SEQ
		, #{p.YEAR} AS YEAR
		, null        AS STATUS
		FROM
		(
		SELECT * FROM VILLAGE_KPI WHERE LEVEL = 1
		) L1
		INNER JOIN
		(
		SELECT * FROM VILLAGE_KPI WHERE LEVEL = 2
		) L2 ON (L1.KPI_CD = L2.P_KPI_CD)
		INNER JOIN
		(
		SELECT * FROM VILLAGE_KPI WHERE LEVEL = 3
		) L3 ON (L2.KPI_CD = L3.P_KPI_CD)
		ORDER BY L3.LEVEL, L3.DISP_ORD

	</select>




	<!-- 성과지표 등급별 분석 - 등급항목별 - 전체기업-->
	<select id="chartGrade1Grade" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND RESULT in ('1', '2')
		UNION ALL
		SELECT 'W' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND RESULT in ('3', '4', '5')
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND RESULT in ('6', '7')
	</select>

	<!-- 성과지표 등급별 분석 등급항목별- 사회적기업 -->
	<select id="chartGrade2Grade" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 1 AND RESULT in ('1', '2')
		UNION ALL
		SELECT 'W' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 1 AND RESULT in ('3', '4', '5')
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 1 AND RESULT in ('6', '7')
	</select>

	<!-- 성과지표 등급별 분석 등급항목별- 마을기업 -->
	<select id="chartGrade3Grade" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 2 AND RESULT in ('1', '2')
		UNION ALL
		SELECT 'W' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 2 AND RESULT in ('3', '4', '5')
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 2 AND RESULT in ('6', '7')
	</select>

	<!-- 성과지표 등급별 분석 등급항목별- 협동조합-->
	<select id="chartGrade4Grade" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 3 AND RESULT in ('1', '2')
		UNION ALL
		SELECT 'W' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 3 AND RESULT in ('3', '4', '5')
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = 3 AND RESULT in ('6', '7')
	</select>






	<!-- 성과지표 등급별 분석 비율항목별 - 전체기업-->
	<select id="chartGrade1Rate" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND RESULT AND 50 >= RESULT
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND RESULT > 50
	</select>

	<!-- 성과지표 등급별 분석 등급항목별- 사회적기업 -->
	<select id="chartGrade2Rate" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = 1 AND 50 >= RESULT
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = 1 AND RESULT > 50
	</select>

	<!-- 성과지표 등급별 분석 등급항목별- 마을기업 -->
	<select id="chartGrade3Rate" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = 2 AND  50 >= RESULT
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = 2 AND  RESULT > 50
	</select>

	<!-- 성과지표 등급별 분석 등급항목별- 협동조합-->
	<select id="chartGrade4Rate" resultType="hashmap">
		SELECT 'B' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = 3 AND  50 = RESULT
		UNION ALL
		SELECT 'G' AS STATUS, count(*) AS COUNT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = 3 AND RESULT > 50
	</select>







	<!-- 성과지표 1단계 항목별  분석 등급항목 -  전체기업-->
	<select id="chartKpiAllGrade" resultType="hashmap">
	  SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
	  FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND (KPI_CD like '0101%' OR KPI_CD like '0102%') AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

      SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
	  FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL


		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND KPI_CD like '02%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

			 SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND KPI_CD like '03%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

			 SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			 AND KPI_CD like '04%' AND ( RESULT >= 1 AND 7 >= RESULT )
	</select>

	<!-- 성과지표 1단계 항목별 분석 등급항목 - 사회적기업,마을기업,협동조합-->
	<select id="chartKpiEachGrade" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}	AND (KPI_CD like '0101%' OR KPI_CD like '0102%') AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

				SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '02%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '03%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '04%' AND ( RESULT >= 1 AND 7 >= RESULT )
	</select>

	<!-- 성과지표 1단계 항목별  분석 비율항목 -  전체기업-->
	<select id="chartKpiAllRate" resultType="hashmap">
	  SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
	  FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
			 AND KPI_CD like '0104%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

      SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
	  FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
				OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
				OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
			 AND KPI_CD like '0104%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 2  AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 0 AND 100 >= RESULT )
	</select>

	<!-- 성과지표 1단계 항목별 분석 비율항목 - 사회적기업,마을기업,협동조합-->
	<select id="chartKpiEachRate" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0104%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0104%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '02%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '03%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '04%' AND ( RESULT >= 0 AND 100 >= RESULT )
	</select>








    <!-- 성과지표 2단계 항목별  분석 등급항목 -  전체기업-->
    <select id="chartKpiDetailAllGrade" resultType="hashmap">
        SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0101%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0102%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0201%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0301%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0401%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 6 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0402%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 7 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0403%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 8 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND KPI_CD like '0404%' AND ( RESULT >= 1 AND 7 >= RESULT )

    </select>

    <!-- 성과지표 2단계 항목별 분석 등급항목 - 사회적기업,마을기업,협동조합-->
    <select id="chartKpiDetailEachGrade" resultType="hashmap">
        SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0101%'  AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0102%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0201%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0301%' AND ( RESULT >= 1 AND 7 >= RESULT )

         UNION ALL

        SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0401%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 6 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0402%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 7 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0403%' AND ( RESULT >= 1 AND 7 >= RESULT )

        UNION ALL

        SELECT 8 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0404%' AND ( RESULT >= 1 AND 7 >= RESULT )



    </select>

    <!-- 성과지표 2단계 항목별  분석 비율항목 -  전체기업-->
    <select id="chartKpiDetailAllRate" resultType="hashmap">
       SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND KPI_CD like '0104%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND KPI_CD like '0202%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND KPI_CD like '0302%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND KPI_CD like '0303%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND KPI_CD like '0405%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND KPI_CD like '0406%' AND ( RESULT >= 0 AND 100 >= RESULT )
    </select>

    <!-- 성과지표 2단계 항목별 분석 비율항목 - 사회적기업,마을기업,협동조합-->
    <select id="chartKpiDetailEachRate" resultType="hashmap">
        SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0104%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}	AND KPI_CD like '0202%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0302%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0303%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0405%' AND ( RESULT >= 0 AND 100 >= RESULT )

        UNION ALL

        SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
        FROM kpi_result
        WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
        OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
        AND CORP_TYPE = #{p.CORP_KIND}   AND KPI_CD like '0406%' AND ( RESULT >= 0 AND 100 >= RESULT )
    </select>









	<!-- 성과지표 지역별 분석 등급항목 전체 -->
	<select id="chartRegionAllGrade" resultType="hashmap">
	SELECT FOUR.CD AS REGION, IFNULL(THR.RESULT,0) AS RESULT
	FROM
		(SELECT SEC.REGION AS REGION, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
			SELECT CORP_SEQ, RESULT FROM KPI_RESULT
			WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
			OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
			OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0  AND SEC.REGION IS NOT NULL
  		GROUP BY REGION) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='REGION' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.REGION )
  		ORDER BY RESULT DESC
	</select>

	<!-- 성과지표 지역별 분석 등급항목 - 사회적기업,마을기업,협동조합 -->
	<select id="chartRegionEachGrade" resultType="hashmap">
	SELECT FOUR.CD AS REGION, IFNULL(THR.RESULT,0) AS RESULT
	FROM
		(SELECT SEC.REGION AS REGION, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
			SELECT CORP_SEQ, RESULT FROM KPI_RESULT
			WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
			OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
			OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
			AND CORP_TYPE = #{p.CORP_KIND}
			) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0  AND SEC.REGION IS NOT NULL
		GROUP BY REGION) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='REGION' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.REGION )
		ORDER BY RESULT DESC
	</select>

	<!-- 성과지표 지역별 분석 비율항목 전체 -->
	<select id="chartRegionAllRate" resultType="hashmap">
		SELECT FOUR.CD AS REGION, IFNULL(THR.RESULT,0) AS RESULT
		FROM
		(SELECT SEC.REGION AS REGION, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0  AND SEC.REGION IS NOT NULL
		GROUP BY REGION) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='REGION' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.REGION )
		ORDER BY RESULT DESC
	</select>

	<!-- 성과지표 지역별 분석 비율항목 - 사회적기업,마을기업,협동조합 -->
	<select id="chartRegionEachRate" resultType="hashmap">
		SELECT FOUR.CD AS REGION, IFNULL(THR.RESULT,0) AS RESULT
		FROM
		(SELECT SEC.REGION AS REGION, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND CORP_TYPE = #{p.CORP_KIND}
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0  AND SEC.REGION IS NOT NULL
		GROUP BY REGION) AS THR RIGHT JOIN (SELECT CD, CD_NM FROM CODE WHERE GRP_CD ='REGION' and CD_NM IS NOT NULL) AS FOUR ON ( FOUR.CD = THR.REGION )
		ORDER BY RESULT	 DESC
	</select>



	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 농업, 임업 및 어업 -->
	<select id="chartSectorGradeTotalType1" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '1'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '1'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '1'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '1'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '1'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '1'
	</select>


	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 제조업 -->
	<select id="chartSectorGradeTotalType2" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '2'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '2'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '2'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '2'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '2'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '2'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 도매 및 소매업 -->
	<select id="chartSectorGradeTotalType3" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '3'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '3'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '3'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '3'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '3'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '3'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 운수업 -->
	<select id="chartSectorGradeTotalType4" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '4'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '4'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '4'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '4'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '4'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '4'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 숙박 및 음식점업 -->
	<select id="chartSectorGradeTotalType5" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '5'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '5'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '5'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '5'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '5'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '5'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 사업시설관리 및 사업지원서비스업 -->
	<select id="chartSectorGradeTotalType6" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '6'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '6'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '6'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '6'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '6'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '6'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 교육 서비스업 -->
	<select id="chartSectorGradeTotalType7" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '7'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '7'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '7'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '7'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '7'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '7'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 보건업 및 사회복지서비스업 -->
	<select id="chartSectorGradeTotalType8" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '8'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '8'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '8'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '8'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '8'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '8'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 예술, 스포츠 및 여가관련 서비스업 -->
	<select id="chartSectorGradeTotalType9" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '9'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '9'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '9'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '9'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '9'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '9'
	</select>


	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 협회 및 단체, 수리 및 기타 개인 서비스업 -->
	<select id="chartSectorGradeTotalType10" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '10'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '10'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '10'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '10'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '10'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '10'
	</select>


	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 인쇄/출판/디자인 -->
	<select id="chartSectorGradeTotalType11" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '11'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '11'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '11'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '11'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '11'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '11'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 운송/배달 -->
	<select id="chartSectorGradeTotalType12" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '12'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '12'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '12'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '12'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '12'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '12'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 기타 -->
	<select id="chartSectorGradeTotalType13" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '13'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '13'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '13'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '13'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '13'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '13'
	</select>




	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 개별  : 농업, 임업 및 어업 -->
	<select id="chartSectorGradeType1" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 제조업 -->
	<select id="chartSectorGradeType2" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 개별  : 도매 및 소매업 -->
	<select id="chartSectorGradeType3" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 운수업 -->
	<select id="chartSectorGradeType4" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 개별  : 숙박 및 음식점업 -->
	<select id="chartSectorGradeType5" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 사업시설관리 및 사업지원서비스업 -->
	<select id="chartSectorGradeType6" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 개별  : 교육 서비스업 -->
	<select id="chartSectorGradeType7" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 보건업 및 사회복지서비스업 -->
	<select id="chartSectorGradeType8" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 예술, 스포츠 및 여가관련 서비스업 -->
	<select id="chartSectorGradeType9" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '9' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '9' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '9' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '9' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '9' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '9' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 협회 및 단체, 수리 및 기타 개인 서비스업 -->
	<select id="chartSectorGradeType10" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '10' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '10' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '10' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '10' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '	0' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '10' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 인쇄/출판/디자인 -->
	<select id="chartSectorGradeType11" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '11' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '11' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '11' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '11' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '11' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '11' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 운송/배달 -->
	<select id="chartSectorGradeType12" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '12' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '12' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '12' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '12' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '12' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '12' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 기타 -->
	<select id="chartSectorGradeType13" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.SECTOR = '13' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.SECTOR = '13' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.SECTOR = '13' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '13' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.SECTOR = '13' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.SECTOR = '13' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 농업, 임업 및 어업 -->
	<select id="chartSectorRateTotalType1" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '1'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '1'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '1'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '1'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '1'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '1'
	</select>


	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 제조업 -->
	<select id="chartSectorRateTotalType2" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '2'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '2'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '2'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '2'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '2'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '2'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 도매 및 소매업 -->
	<select id="chartSectorRateTotalType3" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '3'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '3'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '3'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '3'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '3'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '3'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 운수업 -->
	<select id="chartSectorRateTotalType4" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '4'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '4'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '4'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '4'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '4'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '4'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 숙박 및 음식점업 -->
	<select id="chartSectorRateTotalType5" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '5'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '5'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '5'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '5'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '5'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '5'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 사업시설관리 및 사업지원서비스업 -->
	<select id="chartSectorRateTotalType6" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '6'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '6'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '6'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '6'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '6'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '6'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 교육 서비스업 -->
	<select id="chartSectorRateTotalType7" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '7'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '7'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '7'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '7'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '7'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '7'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 보건업 및 사회복지서비스업 -->
	<select id="chartSectorRateTotalType8" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '8'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '8'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '8'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '8'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '8'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '8'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 예술, 스포츠 및 여가관련 서비스업 -->
	<select id="chartSectorRateTotalType9" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '9'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '9'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '9'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '9'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '9'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '9'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 협회 및 단체, 수리 및 기타 개인 서비스업 -->
	<select id="chartSectorRateTotalType10" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '10'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '10'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '10'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '10'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '10'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '10'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 인쇄/출판/디자인 -->
	<select id="chartSectorRateTotalType11" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '11'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '11'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '11'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '11'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '11'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '11'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 운송/배달 -->
	<select id="chartSectorRateTotalType12" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '12'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '12'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '12'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '12'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '12'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '12'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 기타 -->
	<select id="chartSectorRateTotalType13" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '13'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '13'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '13'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '13'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '13'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '13'
	</select>



	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 개별  : 농업, 임업 및 어업 -->
	<select id="chartSectorRateType1" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 제조업 -->
	<select id="chartSectorRateType2" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 개별  : 도매 및 소매업 -->
	<select id="chartSectorRateType3" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 운수업 -->
	<select id="chartSectorRateType4" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 개별  : 숙박 및 음식점업 -->
	<select id="chartSectorRateType5" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 사업시설관리 및 사업지원서비스업 -->
	<select id="chartSectorRateType6" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 개별  : 교육 서비스업 -->
	<select id="chartSectorRateType7" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 보건업 및 사회복지서비스업 -->
	<select id="chartSectorRateType8" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 예술, 스포츠 및 여가관련 서비스업 -->
	<select id="chartSectorRateType9" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '9' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '9' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '9' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '9' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '9' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '9' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 협회 및 단체, 수리 및 기타 개인 서비스업 -->
	<select id="chartSectorRateType10" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '10' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '10' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '10' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '10' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '10' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '10' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 인쇄/출판/디자인 -->
	<select id="chartSectorRateType11" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '11' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '11' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '11' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '11' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '11' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '11' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 운송/배달 -->
	<select id="chartSectorRateType12" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '12' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '12' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '12' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '12' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '12' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '12' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 기타-->
	<select id="chartSectorRateType13" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '13' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '13' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '13' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '13' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '13' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '13' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>









	<!-- 성과지표 사회적경제조직 유형별 분석 - 등급항목 통계 전체기업-->
	<select id="chartAllGradeTotal" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND (KPI_CD like '0101%' OR KPI_CD like '0102%') AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 1 AND 7 >= RESULT )

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND ( RESULT >= 1 AND 7 >= RESULT )
	</select>

	<!-- 성과지표 사회적경제조직 유형별 분석 - 등급항목 통계 사회적기업-->
	<select id="chartAllGradeSocial" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND (KPI_CD like '0101%' OR KPI_CD like '0102%') AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 1
	</select>

	<!-- 성과지표 사회적경제조직 유형별 분석 - 등급항목 통계 마을기업-->
	<select id="chartAllGradeVillage" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND (KPI_CD like '0101%' OR KPI_CD like '0102%') AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 2
	</select>


	<!-- 성과지표 사회적경제조직 유형별 분석 - 등급항목 통계 협동조합-->
	<select id="chartAllGradeCooperation" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND  (KPI_CD like '0101%' OR KPI_CD like '0102%')  AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '0103%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		AND ( RESULT >= 1 AND 7 >= RESULT ) AND CORP_TYPE = 3
	</select>

	<!-- 성과지표 사회적경제조직 유형별 분석 - 비율항목 통계 전체기업-->
	<select id="chartAllRateTotal" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 0 AND 100 >= RESULT )

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND ( RESULT >= 0 AND 100 >= RESULT )
	</select>

	<!-- 성과지표 사회적경제조직 유형별 분석 - 비율항목 통계 사회적기업-->
	<select id="chartAllRateSocial" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 1

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 1
	</select>

	<!-- 성과지표 사회적경제조직 유형별 분석 - 비율항목 통계 마을기업-->
	<select id="chartAllRateVillage" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 2

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 2
	</select>


	<!-- 성과지표 사회적경제조직 유형별 분석 - 비율항목 통계 협동조합-->
	<select id="chartAllRateCooperation" resultType="hashmap">
		SELECT 0 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 1 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '01%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 2 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '02%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 3 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '03%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 4 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND KPI_CD like '04%' AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 3

		UNION ALL

		SELECT 5 AS STATUS, ROUND(AVG(result),1) AS RESULT
		FROM kpi_result
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		AND ( RESULT >= 0 AND 100 >= RESULT ) AND CORP_TYPE = 3
	</select>






    <!-- 성과지표 기업별 분석 전체-->
    <select id="gridCorpAll" resultType="hashmap">
	SELECT
		CASE VCK.CORP_TYPE WHEN 1 THEN '사회적기업'
		WHEN 2 THEN '마을기업'
		ELSE '협동조합' END AS CORP_TYPE,
		VCK.CORP_SEQ,
		(SELECT CORP_NM FROM CORP_INFO WHERE CORP_SEQ = VCK.CORP_SEQ) AS CORP_NM,
		SUM(CASE WHEN KPI_TYPE = '01' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_01,
		SUM(CASE WHEN KPI_TYPE = '02' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_02,
		SUM(CASE WHEN KPI_TYPE = '03' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_03,
		SUM(CASE WHEN KPI_TYPE = '04' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_04,
		SUM(CASE WHEN KPI_TYPE = '05' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_05,
		SUM(CASE WHEN KPI_TYPE = 'GRADE_TOT' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_GRADE_TOT,
		SUM(CASE WHEN KPI_TYPE = 'RATE_TOT' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_RATE_TOT
	FROM VIEW_CORP_KPI AS VCK
	GROUP BY CORP_SEQ
	ORDER BY CORP_NM
    </select>



    <!-- 성과지표 기업별 분석 사회적기업/마을기업/협동조합-->
    <select id="gridCorpEach" resultType="hashmap">
	SELECT
		CASE VCK.CORP_TYPE WHEN 1 THEN '사회적기업'
		WHEN 2 THEN '마을기업'
		ELSE '협동조합' END AS CORP_TYPE,
		VCK.CORP_SEQ,
		(SELECT CORP_NM FROM CORP_INFO WHERE CORP_SEQ = VCK.CORP_SEQ) AS CORP_NM,
		SUM(CASE WHEN KPI_TYPE = '01' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_01,
		SUM(CASE WHEN KPI_TYPE = '02' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_02,
		SUM(CASE WHEN KPI_TYPE = '03' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_03,
		SUM(CASE WHEN KPI_TYPE = '04' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_04,
		SUM(CASE WHEN KPI_TYPE = '05' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_05,
		SUM(CASE WHEN KPI_TYPE = 'GRADE_TOT' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_GRADE_TOT,
		SUM(CASE WHEN KPI_TYPE = 'RATE_TOT' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_RATE_TOT
	FROM VIEW_CORP_KPI AS VCK
	WHERE VCK.CORP_TYPE = #{p.CORP_KIND}
	GROUP BY CORP_SEQ
	ORDER BY CORP_NM
    </select>

	<!-- 성과지표 기업별 분석 키워드 검색-->
	<select id="gridCorpKeyword" resultType="hashmap">
		SELECT
		CASE VCK.CORP_TYPE WHEN 1 THEN '사회적기업'
		WHEN 2 THEN '마을기업'
		ELSE '협동조합' END AS CORP_TYPE,
		VCK.CORP_SEQ,
		(SELECT CORP_NM FROM CORP_INFO WHERE CORP_SEQ = VCK.CORP_SEQ) AS CORP_NM,
		SUM(CASE WHEN KPI_TYPE = '01' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_01,
		SUM(CASE WHEN KPI_TYPE = '02' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_02,
		SUM(CASE WHEN KPI_TYPE = '03' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_03,
		SUM(CASE WHEN KPI_TYPE = '04' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_04,
		SUM(CASE WHEN KPI_TYPE = '05' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_05,
		SUM(CASE WHEN KPI_TYPE = 'GRADE_TOT' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_GRADE_TOT,
		SUM(CASE WHEN KPI_TYPE = 'RATE_TOT' THEN IFNULL(ROUND(RESULT,1),0) ELSE 0 END) AS KPI_TYPE_RATE_TOT
		FROM VIEW_CORP_KPI AS VCK
		WHERE (SELECT CORP_NM FROM CORP_INFO WHERE CORP_SEQ = VCK.CORP_SEQ) LIKE CONCAT('%',#{p.KEYWORD},'%')
		GROUP BY CORP_SEQ
		ORDER BY CORP_NM
	</select>




	<!-- 전체기업 상세정보 조회 전체-->
	<select id="allCorpsAll" resultType="hashmap">
        SELECT
          CORP_NM		/*기업명*/
        , CORP_TYPE
		, CASE CORP_TYPE WHEN 1 THEN '사회적기업'
		  WHEN 2 THEN '마을기업'
		  ELSE '협동조합' END AS CORP_TYPE_NM
		, REG_EMP_CNT	/*g5 정규직 근로자수 */
		, REG_WEEK_TIME	/*g6 정규직 주당평균 근로시간 */
		, REG_MONTH_PAY	/*g7 정규직 월 평균임금 */
		, REG_EMP_TIME	/*g8 정규직 평균 근속기간 */
		, COM_EMP_CNT + CONTRACT_EMP_CNT + TIME_EMP_CNT AS NON_EMP_CNT  /* 비정규직 근로자수 */
		, COM_WEEK_TIME + CONTRACT_WEEK_TIME + TIME_WEEK_TIME  AS NON_WEEK_TIME /* 비정규직 주당 평균 근로기간 */
		, COM_MONTH_PAY + CONTRACT_MONTH_PAY + TIME_MONTH_PAY AS NON_MONTH_PAY /* 비정규직 월 평균임금 */
		, COM_EMP_TIME + CONTRACT_EMP_TIME + TIME_EMP_TIME AS NON_EMP_TIME /* 비정규직 평균 근속기간 */
		, VOL_EMP_CNT		/*g25 자원봉사자 근로자수 */
		, VOL_WEEK_TIME		/*g26 자원봉사자 주당평균 근로시간 */
		, WEAK_REG_EMP_CNT		/*g31 정규직 근로자수 */
		, WEAK_REG_WEEK_TIME	/*g32 정규직 주당평균 근로시간 */
		, WEAK_REG_MONTH_PAY	/*g33 정규직 월 평균임금 */
		, WEAK_REG_EMP_TIME		/*g34 정규직 평균 근속기간 */
		, WEAK_COM_EMP_CNT + WEAK_CONTRACT_EMP_CNT + WEAK_TIME_EMP_CNT	AS WEAK_NON_EMP_CNT	/* 비정규직 근로자수 */
		, WEAK_COM_WEEK_TIME + WEAK_CONTRACT_WEEK_TIME + WEAK_TIME_WEEK_TIME  AS WEAK_NON_WEEK_TIME 	/* 비정규직 주당평균 근로시간 */
		, WEAK_COM_MONTH_PAY + WEAK_CONTRACT_MONTH_PAY + WEAK_TIME_MONTH_PAY AS WEAK_NON_MONTH_PAY 	/* 비정규직 월 평균임금 */
		, WEAK_COM_EMP_TIME + WEAK_CONTRACT_EMP_TIME + WEAK_TIME_EMP_TIME AS WEAK_NON_EMP_TIME 	/* 비정규직 평균 근속기간 */
		, WEAK_TYPE1_CNT	/*g52 취약계층 고령자 고용인원 */
		, WEAK_TYPE2_CNT	/*g53 취약계층 장애인 고용인원 */
		, WEAK_TYPE3_CNT	/*g54 취약계층 저소득 고용인원 */
		, WEAK_TYPE4_CNT	/*g55 취약계층 경력단절여성 고용인원 */
		, WEAK_TYPE5_CNT	/*g56 취약계층 장기실업 고용인원 */
		, WEAK_TYPE6_CNT	/*g57 취약계층 결혼이민 고용인원 */
		, WEAK_TYPE7_CNT	/*g58 취약계층 기타 고용인원 */
		, CORP_ASSET		/*h3 자산 */
		, CORP_CAPITAL		/*h4 자본 */
		, CORP_DEBT			/*h5 부채 */
		, PROFIT_SURPLUS 	/*이익잉여금*/
		, CORP_SALES		/*h6 매출액 */
		, CORP_SALES_PROFIT	/*h7 매출 총이익 */
		, CORP_LABOR_COST	/*h8 노무비 */
		, CORP_TAX			/*h9 법인세 */
		, CORP_OP_PROFIT	/*h10 영업이익 */
		, CORP_NET_INCOM	/*h14 당기순이익 */
		, NON_OP_INCOM		/* 영업외이익 */
		, GOV_SUP_ASSET		/*h12 정부지원금 - 건물 등 자산취득 관련 지원금 */
		, GOV_SUP_COST		/*h11 징부지원금 - 인건비 등 비용관련 지원금 */
		, SPONSOR_DONATE	/*h13 각종 후원금, 기부금 */
        FROM CORP_INFO
     	ORDER BY CORP_NM
	</select>


	<!-- 전체기업 상세정보 조회 사회적기업/마을기업/협동조합-->
	<select id="allCorpsEach" resultType="hashmap">
		SELECT
          CORP_NM		/*기업명*/
        , CORP_TYPE
		, CASE CORP_TYPE WHEN 1 THEN '사회적기업'
		  WHEN 2 THEN '마을기업'
		  ELSE '협동조합' END AS CORP_TYPE_NM
		, REG_EMP_CNT	/*g5 정규직 근로자수 */
		, REG_WEEK_TIME	/*g6 정규직 주당평균 근로시간 */
		, REG_MONTH_PAY	/*g7 정규직 월 평균임금 */
		, REG_EMP_TIME	/*g8 정규직 평균 근속기간 */
		, COM_EMP_CNT + CONTRACT_EMP_CNT + TIME_EMP_CNT AS NON_EMP_CNT  /* 비정규직 근로자수 */
		, COM_WEEK_TIME + CONTRACT_WEEK_TIME + TIME_WEEK_TIME  AS NON_WEEK_TIME /* 비정규직 주당 평균 근로기간 */
		, COM_MONTH_PAY + CONTRACT_MONTH_PAY + TIME_MONTH_PAY AS NON_MONTH_PAY /* 비정규직 월 평균임금 */
		, COM_EMP_TIME + CONTRACT_EMP_TIME + TIME_EMP_TIME AS NON_EMP_TIME /* 비정규직 평균 근속기간 */
		, VOL_EMP_CNT		/*g25 자원봉사자 근로자수 */
		, VOL_WEEK_TIME		/*g26 자원봉사자 주당평균 근로시간 */
		, WEAK_REG_EMP_CNT		/*g31 정규직 근로자수 */
		, WEAK_REG_WEEK_TIME	/*g32 정규직 주당평균 근로시간 */
		, WEAK_REG_MONTH_PAY	/*g33 정규직 월 평균임금 */
		, WEAK_REG_EMP_TIME		/*g34 정규직 평균 근속기간 */
		, WEAK_COM_EMP_CNT + WEAK_CONTRACT_EMP_CNT + WEAK_TIME_EMP_CNT	AS WEAK_NON_EMP_CNT	/* 비정규직 근로자수 */
		, WEAK_COM_WEEK_TIME + WEAK_CONTRACT_WEEK_TIME + WEAK_TIME_WEEK_TIME  AS WEAK_NON_WEEK_TIME 	/* 비정규직 주당평균 근로시간 */
		, WEAK_COM_MONTH_PAY + WEAK_CONTRACT_MONTH_PAY + WEAK_TIME_MONTH_PAY AS WEAK_NON_MONTH_PAY 	/* 비정규직 월 평균임금 */
		, WEAK_COM_EMP_TIME + WEAK_CONTRACT_EMP_TIME + WEAK_TIME_EMP_TIME AS WEAK_NON_EMP_TIME 	/* 비정규직 평균 근속기간 */
		, WEAK_TYPE1_CNT	/*g52 취약계층 고령자 고용인원 */
		, WEAK_TYPE2_CNT	/*g53 취약계층 장애인 고용인원 */
		, WEAK_TYPE3_CNT	/*g54 취약계층 저소득 고용인원 */
		, WEAK_TYPE4_CNT	/*g55 취약계층 경력단절여성 고용인원 */
		, WEAK_TYPE5_CNT	/*g56 취약계층 장기실업 고용인원 */
		, WEAK_TYPE6_CNT	/*g57 취약계층 결혼이민 고용인원 */
		, WEAK_TYPE7_CNT	/*g58 취약계층 기타 고용인원 */
		, CORP_ASSET		/*h3 자산 */
		, CORP_CAPITAL		/*h4 자본 */
		, CORP_DEBT			/*h5 부채 */
		, PROFIT_SURPLUS 	/*이익잉여금*/
		, CORP_SALES		/*h6 매출액 */
		, CORP_SALES_PROFIT	/*h7 매출 총이익 */
		, CORP_LABOR_COST	/*h8 노무비 */
		, CORP_TAX			/*h9 법인세 */
		, CORP_OP_PROFIT	/*h10 영업이익 */
		, CORP_NET_INCOM	/*h14 당기순이익 */
		, NON_OP_INCOM		/* 영업외이익 */
		, GOV_SUP_ASSET		/*h12 정부지원금 - 건물 등 자산취득 관련 지원금 */
		, GOV_SUP_COST		/*h11 징부지원금 - 인건비 등 비용관련 지원금 */
		, SPONSOR_DONATE	/*h13 각종 후원금, 기부금 */
		FROM CORP_INFO
		WHERE CORP_TYPE = #{p.CORP_KIND}
		ORDER BY CORP_NM
	</select>


	<!-- 전체기업 상세정보 조회 키워드 검색-->
	<select id="allCorpsKeyword" resultType="hashmap">
        SELECT
          CORP_NM		/*기업명*/
        , CORP_TYPE
		, CASE CORP_TYPE WHEN 1 THEN '사회적기업'
		  WHEN 2 THEN '마을기업'
		  ELSE '협동조합' END AS CORP_TYPE_NM
		, REG_EMP_CNT	/*g5 정규직 근로자수 */
		, REG_WEEK_TIME	/*g6 정규직 주당평균 근로시간 */
		, REG_MONTH_PAY	/*g7 정규직 월 평균임금 */
		, REG_EMP_TIME	/*g8 정규직 평균 근속기간 */
		, COM_EMP_CNT + CONTRACT_EMP_CNT + TIME_EMP_CNT AS NON_EMP_CNT  /* 비정규직 근로자수 */
		, COM_WEEK_TIME + CONTRACT_WEEK_TIME + TIME_WEEK_TIME  AS NON_WEEK_TIME /* 비정규직 주당 평균 근로기간 */
		, COM_MONTH_PAY + CONTRACT_MONTH_PAY + TIME_MONTH_PAY AS NON_MONTH_PAY /* 비정규직 월 평균임금 */
		, COM_EMP_TIME + CONTRACT_EMP_TIME + TIME_EMP_TIME AS NON_EMP_TIME /* 비정규직 평균 근속기간 */
		, VOL_EMP_CNT		/*g25 자원봉사자 근로자수 */
		, VOL_WEEK_TIME		/*g26 자원봉사자 주당평균 근로시간 */
		, WEAK_REG_EMP_CNT		/*g31 정규직 근로자수 */
		, WEAK_REG_WEEK_TIME	/*g32 정규직 주당평균 근로시간 */
		, WEAK_REG_MONTH_PAY	/*g33 정규직 월 평균임금 */
		, WEAK_REG_EMP_TIME		/*g34 정규직 평균 근속기간 */
		, WEAK_COM_EMP_CNT + WEAK_CONTRACT_EMP_CNT + WEAK_TIME_EMP_CNT	AS WEAK_NON_EMP_CNT	/* 비정규직 근로자수 */
		, WEAK_COM_WEEK_TIME + WEAK_CONTRACT_WEEK_TIME + WEAK_TIME_WEEK_TIME  AS WEAK_NON_WEEK_TIME 	/* 비정규직 주당평균 근로시간 */
		, WEAK_COM_MONTH_PAY + WEAK_CONTRACT_MONTH_PAY + WEAK_TIME_MONTH_PAY AS WEAK_NON_MONTH_PAY 	/* 비정규직 월 평균임금 */
		, WEAK_COM_EMP_TIME + WEAK_CONTRACT_EMP_TIME + WEAK_TIME_EMP_TIME AS WEAK_NON_EMP_TIME 	/* 비정규직 평균 근속기간 */
		, WEAK_TYPE1_CNT	/*g52 취약계층 고령자 고용인원 */
		, WEAK_TYPE2_CNT	/*g53 취약계층 장애인 고용인원 */
		, WEAK_TYPE3_CNT	/*g54 취약계층 저소득 고용인원 */
		, WEAK_TYPE4_CNT	/*g55 취약계층 경력단절여성 고용인원 */
		, WEAK_TYPE5_CNT	/*g56 취약계층 장기실업 고용인원 */
		, WEAK_TYPE6_CNT	/*g57 취약계층 결혼이민 고용인원 */
		, WEAK_TYPE7_CNT	/*g58 취약계층 기타 고용인원 */
		, CORP_ASSET		/*h3 자산 */
		, CORP_CAPITAL		/*h4 자본 */
		, CORP_DEBT			/*h5 부채 */
		, PROFIT_SURPLUS 	/*이익잉여금*/
		, CORP_SALES		/*h6 매출액 */
		, CORP_SALES_PROFIT	/*h7 매출 총이익 */
		, CORP_LABOR_COST	/*h8 노무비 */
		, CORP_TAX			/*h9 법인세 */
		, CORP_OP_PROFIT	/*h10 영업이익 */
		, CORP_NET_INCOM	/*h14 당기순이익 */
		, NON_OP_INCOM		/* 영업외이익 */
		, GOV_SUP_ASSET		/*h12 정부지원금 - 건물 등 자산취득 관련 지원금 */
		, GOV_SUP_COST		/*h11 징부지원금 - 인건비 등 비용관련 지원금 */
		, SPONSOR_DONATE	/*h13 각종 후원금, 기부금 */
        FROM CORP_INFO
        WHERE CORP_NM LIKE CONCAT('%',#{p.KEYWORD},'%')
     	ORDER BY CORP_NM
	</select>



















	<!-- 성과지표 사회적목적 유형별 분석 - 등급항목 통계  : 전체 -->
	<select id="chartTypeGradeTotal" resultType="hashmap">
	SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
	FROM
	(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
	WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 != '0'

	UNION ALL

	SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
	FROM
	(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
	WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 != '0'

	UNION ALL

	SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
	FROM
	(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
	WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 != '0'

	UNION ALL

	SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
	FROM
	(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
	WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 != '0'

	UNION ALL

	SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
	FROM
	(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
	WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 != '0'


	UNION ALL

	SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
	FROM
	(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
	WHERE FIR.RESULT != 0 AND SEC.LEG_TYPE2 != '0'
	</select>

	<!-- 성과지표 사회적목적 유형별 분석 - 등급항목 통계  : 노동통합형 -->
	<select id="chartTypeGradeType1" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '1'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '1'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '1'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '1'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '1'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '1'
	</select>

	<!-- 성과지표 사회적목적 유형별 분석 - 등급항목 통계  : 문제해결형 -->
	<select id="chartTypeGradeType2" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '2'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '2'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '2'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '2'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '2'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '2'
	</select>

	<!-- 성과지표 사회적목적 유형별 분석 - 등급항목 통계  : 지역사회 혁신형 -->
	<select id="chartTypeGradeType3" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '3'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '3'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '3'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '3'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '3'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '3'
	</select>

	<!-- 성과지표 사회적목적 유형별 분석 - 등급항목 통계  : 고용창출형 -->
	<select id="chartTypeGradeType4" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '4'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '4'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '4'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '4'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '4'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '4'
	</select>

	<!-- 성과지표 사회적목적 유형별 분석 - 비율항목 통계  : 전체 -->
	<select id="chartTypeRateTotal" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 != '0'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 != '0'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 != '0'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 != '0'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 != '0'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.LEG_TYPE2 != '0'
	</select>

	<!-- 성과지표 사회적목적 유형별 분석 - 등급항목 통계  : 노동통합형 -->
	<select id="chartTypeRateType1" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%'  AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '1'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '1'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '1'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '1'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '1'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '1'
	</select>

	<!-- 성과지표 사회적목적 유형별 분석 - 비율항목 통계  : 문제해결형 -->
	<select id="chartTypeRateType2" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%'  AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '2'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '2'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '2'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '2'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '2'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '2'
	</select>

	<!-- 성과지표 사회적목적 유형별 분석 - 비율항목 통계  : 지역사회 혁신형 -->
	<select id="chartTypeRateType3" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%'  AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '3'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '3'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '3'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '3'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '3'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '3'
	</select>

	<!-- 성과지표 사회적목적 유형별 분석 - 비율항목 통계  : 고용창출형 -->
	<select id="chartTypeRateType4" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '4'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '4'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '4'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '4'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.LEG_TYPE2 = '4'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.LEG_TYPE2 = '4'
	</select>


	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 중구 -->
	<select id="chartRegionGradeTotalType1" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '1'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '1'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '1'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '1'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '1'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '1'
	</select>


	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 동구 -->
	<select id="chartRegionGradeTotalType2" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '2'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '2'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '2'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '2'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '2'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '2'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 서구 -->
	<select id="chartRegionGradeTotalType3" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '3'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '3'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '3'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '3'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '3'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '3'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 남구 -->
	<select id="chartRegionGradeTotalType4" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '4'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '4'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '4'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '4'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '4'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '4'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 북구 -->
	<select id="chartRegionGradeTotalType5" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '5'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '5'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '5'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '5'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '5'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '5'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 수성구 -->
	<select id="chartRegionGradeTotalType6" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '6'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '6'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '6'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '6'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '6'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '6'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 달서구 -->
	<select id="chartRegionGradeTotalType7" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '7'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '7'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '7'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '7'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '7'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '7'
	</select>

	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 달성구 -->
	<select id="chartRegionGradeTotalType8" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '8'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '8'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '8'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '8'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '8'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '8'
	</select>




	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 개별  : 중구 -->
	<select id="chartRegionGradeType1" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 동구 -->
	<select id="chartRegionGradeType2" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 개별  : 서구 -->
	<select id="chartRegionGradeType3" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 남구 -->
	<select id="chartRegionGradeType4" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 개별  : 북구 -->
	<select id="chartRegionGradeType5" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 수성구 -->
	<select id="chartRegionGradeType6" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 개별  : 달서구 -->
	<select id="chartRegionGradeType7" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 등급항목 통계 - 전체  : 달성구 -->
	<select id="chartRegionGradeType8" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE (FIR.KPI_CD like '0101%' OR FIR.KPI_CD like '0102%') AND FIR.RESULT != 0 AND SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '0103%' AND FIR.RESULT != 0 AND SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'Y' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'Y' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 중구 -->
	<select id="chartRegionRateTotalType1" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '1'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '1'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '1'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '1'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '1'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '1'
	</select>


	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 동구 -->
	<select id="chartRegionRateTotalType2" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '2'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '2'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '2'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '2'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '2'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '2'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 서구 -->
	<select id="chartRegionRateTotalType3" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '3'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '3'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '3'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '3'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '3'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '3'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 남구 -->
	<select id="chartRegionRateTotalType4" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '4'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '4'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '4'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '4'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '4'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '4'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 북구 -->
	<select id="chartRegionRateTotalType5" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '5'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '5'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '5'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '5'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '5'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '5'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 수성구 -->
	<select id="chartRegionRateTotalType6" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '6'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '6'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '6'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '6'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '6'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '6'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 달서구 -->
	<select id="chartRegionRateTotalType7" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '7'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '7'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '7'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '7'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '7'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '7'
	</select>

	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 달성구 -->
	<select id="chartRegionRateTotalType8" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '8'

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '8'

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '8'

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '8'

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '8'


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '8'
	</select>






	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 개별  : 중구 -->
	<select id="chartRegionRateType1" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '1' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 동구 -->
	<select id="chartRegionRateType2" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '2' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 개별  : 서구 -->
	<select id="chartRegionRateType3" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '3' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 남구 -->
	<select id="chartRegionRateType4" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '4' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 개별  : 북구 -->
	<select id="chartRegionRateType5" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '5' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 수성구 -->
	<select id="chartRegionRateType6" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '6' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>



	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 개별  : 달서구 -->
	<select id="chartRegionRateType7" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '7' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>


	<!-- 성과지표 지역별 분석 - 비율항목 통계 - 전체  : 달성구 -->
	<select id="chartRegionRateType8" resultType="hashmap">
		SELECT 0 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 1 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '01%' AND FIR.RESULT != 0 AND SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 2 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '02%' AND FIR.RESULT != 0 AND SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 3 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '03%' AND FIR.RESULT != 0 AND  SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}

		UNION ALL

		SELECT 4 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.KPI_CD like '04%' AND FIR.RESULT != 0 AND  SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}


		UNION ALL

		SELECT 5 AS TYPE, ROUND(AVG(FIR.RESULT),1) AS RESULT
		FROM
		(
		SELECT CORP_SEQ, KPI_CD, RESULT FROM KPI_RESULT
		WHERE ( ( CORP_TYPE = 1 AND KPI_CD in ( SELECT KPI_CD FROM SOCIAL_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 2 AND KPI_CD in ( SELECT KPI_CD FROM VILLAGE_KPI WHERE IS_GRADE = 'N' ) )
		OR ( CORP_TYPE = 3 AND KPI_CD in ( SELECT KPI_CD FROM COOPERATION_KPI WHERE IS_GRADE = 'N' ) ) )
		) AS FIR INNER JOIN CORP_INFO AS SEC ON ( FIR.CORP_SEQ = SEC.CORP_SEQ )
		WHERE FIR.RESULT != 0 AND SEC.REGION = '8' AND SEC.CORP_TYPE = #{p.CORP_KIND}
	</select>






</mapper>
